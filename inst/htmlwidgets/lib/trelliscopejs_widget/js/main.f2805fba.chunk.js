(this["webpackJsonptrelliscopejs-lib"]=this["webpackJsonptrelliscopejs-lib"]||[]).push([[0],{169:function(e,t,a){e.exports=a(199)},179:function(e,t,a){},180:function(e,t,a){},181:function(e,t,a){},199:function(e,t,a){"use strict";a.r(t);var n=a(0),i=a.n(n),l=a(17),o=a.n(l),s=a(13),r=a(50),c=a(123),d=a(124),p=a(145),h=a(278),m=(a(178),a(107)),g=a.n(m),u=a(108),b=a.n(u);const f=["Panel Grid Layout","Filter Panels","Sort Panels","Show/Hide Labels","Views"],v={};f.forEach((e,t)=>{v[e]=t}),v[""]=-1;const y=e=>t=>a=>{const n=["SELECT_DISPLAY","SET_LAYOUT","SET_LABELS","SET_SORT","SET_FILTER","ACTIVE_SIDEBAR","SET_FILTER_VIEW"],i=t(a);if(n.indexOf(a.type)>-1){const t=(e=>{const t=e.selectedDisplay,a=e.layout,n="nrow=".concat(a.nrow,"&ncol=").concat(a.ncol,"&arr=").concat(a.arrange,"&pg=").concat(a.pageNum),i=e.labels,l=e.sort;l.sort((e,t)=>e.order>t.order?1:-1);const o=l.map(e=>"".concat(e.name,";").concat(e.dir)).join(","),s=e.filter,r=Object.keys(s.state).map(e=>{const t=s.state[e];let a="";if("select"===t.type)a="var:".concat(t.name,";type:select;val:").concat(t.value.map(encodeURIComponent).join("#"));else if("regex"===t.type)a="var:".concat(t.name,";type:regex;val:").concat(encodeURIComponent(t.regex));else if("range"===t.type){const e=t.value.from?t.value.from:"",n=t.value.to?t.value.to:"";a="var:".concat(t.name,";type:range;from:").concat(e,";to:").concat(n)}return a}),c=e.sidebar,d=v[c.active];let p="";s.view.active&&(p=s.view.active.join(","));return"display=".concat(t.name,"&").concat(n,"&labels=").concat(i.join(","),"&sort=").concat(o,"&filter=").concat(r.join(","),"&sidebar=").concat(d,"&fv=").concat(p)})(e.getState());window.location.hash!==t&&(window.location.hash=t)}return i},w=(e,t)=>e.classList?e.classList.contains(t):!!e.className.match(new RegExp("'(\\s|^)'".concat(t,"'(\\s|$)'"))),E=(e,t)=>{e.classList?e.classList.add(t):w(e,t)||(e.className+=" ".concat(t))},x=(e,t)=>{if(e.classList)e.classList.remove(t);else if(w(e,t)){const a=new RegExp("'(\\s|^)'".concat(t,"'(\\s|$)'"));e.className=e.className.replace(a," ")}};a(179),a(180),a(181);var S=a(97),_=a(146),O=a(60),C=a.n(O);const I=e=>{const t=window.HTMLWidgets.widgets;for(let a=0;a<t.length;a+=1)if(t[a].name===e)return t[a]},k=e=>Object(S.a)(e.url,t=>e.callback(t)),N=e=>({type:"WINDOW_RESIZE",dims:e}),D=e=>({type:"UPDATE_DIMS",dims:e}),j=e=>({type:"RECEIVE_CONFIG",config:e,receivedAt:Date.now()}),T=e=>({type:"ACTIVE_SIDEBAR",active:e}),L=e=>({type:"SET_DIALOG_OPEN",isOpen:e}),R=e=>({type:"SET_DISPSELECT_DIALOG_OPEN",isOpen:e}),A=e=>({type:"SET_DISPINFO_DIALOG_OPEN",isOpen:e}),z=e=>({type:"SET_LAYOUT",layout:e}),P=e=>({type:"SET_LABELS",labels:e}),B=e=>({type:"SET_SORT",sort:e}),W=e=>({type:"SET_FILTER",filter:e}),F=(e,t)=>({type:"SET_FILTER_VIEW",name:e,which:t}),H=e=>({type:"RECEIVE_DISPLAY_LIST",list:e,receivedAt:Date.now()}),M=(e,t,a)=>({type:"SELECT_DISPLAY",name:e,group:t,desc:a}),U=e=>({type:"SET_SELECTED_RELDISPS",which:"set",val:e}),V=e=>({type:"SET_REL_DISP_POSITIONS",obj:e}),G=(e,t)=>({type:"REQUEST_DISPLAY",name:e,group:t}),K=(e,t,a)=>({type:"RECEIVE_DISPLAY",name:e,group:t,info:a,receivedAt:Date.now()}),Y=(e,t)=>({type:"RECEIVE_COGDATA",iface:e,crossfilter:t,receivedAt:Date.now()}),q=(e,t)=>({type:"SET_PANEL_RENDERER",name:e,fn:t}),Q=e=>({type:"SET_ERROR_MESSAGE",msg:e}),J=(e,t,a,n,i)=>{const l={};i.replace("#","").split("&").forEach(e=>{const t=e.split("=");l[t[0]]=t[[1]]});for(let g=0;g<t.length;g+=1)t[g].__index=g;n(Y(e,Object(_.a)(t)));let o=a.state.sidebar;l.sidebar&&(o=parseInt(l.sidebar,10)),o&&o>=0&&n(T(f[o]));const s=a.state.layout;l.nrow&&(s.nrow=parseInt(l.nrow,10)),l.ncol&&(s.ncol=parseInt(l.ncol,10)),l.arr&&(s.arrange=l.arr),n(z(s)),l.pg&&n(z({pageNum:parseInt(l.pg,10)}));let r=a.state.labels;l.labels&&(r=l.labels.split(",")),n(P(r));let c=a.state.sort;l.sort&&(c=l.sort.split(",").map((e,t)=>{const a=e.split(";");return{order:t+1,name:a[0],dir:a[1]}})),n(B(c));const d=a.state.filter?a.state.filter:{};if(l.filter){l.filter.split(",").forEach(e=>{const t={};e.split(";").forEach(e=>{const a=e.split(":");t[a[0]]=a[[1]]});const n={name:t.var,type:t.type,varType:a.cogInfo[t.var].type};if("select"===t.type)n.orderValue="ct,desc",n.value=t.val.split("#").map(decodeURIComponent);else if("regex"===t.type){const e=a.cogInfo[t.var].levels,i=[],l=new RegExp(decodeURIComponent(t.val),"i");e.forEach(e=>{null!==e.match(l)&&i.push(e)}),n.regex=t.val,n.value=i,n.orderValue="ct,desc"}else if("range"===t.type){const e=t.from?parseFloat(t.from,10):void 0,a=t.to?parseFloat(t.to,10):void 0;n.value={from:e,to:a},n.valid=!0,e&&a&&e>a&&(n.valid=!1)}d[t.var]=n})}let p=[];l.fv&&(p=l.fv.split(","));const h=Object.keys(a.cogInfo),m={active:[],inactive:[]};for(let g=0;g<h.length;g+=1)a.cogInfo[h[g]].filterable&&(p.indexOf(h[g])>-1||a.state.filter&&void 0!==a.state.filter[h[g]]?m.active.push(h[g]):m.inactive.push(h[g]));n(F(m,"set")),n(W(d))},$=(e,t,a)=>{if("image"===e.panelInterface.type)a(q(e.name,(e,t,a)=>i.a.createElement("img",{src:e,alt:"panel",style:{width:t,height:a}})));else if("image_src"===e.panelInterface.type)a(q(e.name,e=>i.a.createElement("img",{src:e,alt:"panel",style:{width:"100%",height:"100%",objectFit:"contain"}})));else if("htmlwidget"===e.panelInterface.type){const n=()=>{const t=I(e.panelInterface.deps.name);a(q(e.name,(e,a,n,l,o)=>{const s=document.getElementById("widget_outer_".concat(o)),r=document.getElementById("widget_".concat(o));if(!l||!s||null!==r)return i.a.createElement("div",{id:"widget_outer_".concat(o)});{const i=document.createElement("div");let l;i.style.width="".concat(a,"px"),i.style.height="".concat(n,"px"),i.setAttribute("id","widget_".concat(o)),s.appendChild(i),t.initialize&&(l=t.initialize(i,a,n)),e.evals instanceof Array||(e.evals=[e.evals]);for(let t=0;e.evals&&t<e.evals.length;t+=1)window.HTMLWidgets.evaluateStringMember(e.x,e.evals[t]);t.renderValue(i,e.x,l)}return null}))};t.config_base?((e,t,a)=>{const n=Object.assign([],e.assets),i=()=>{let e=!1;const l=document.getElementsByTagName("head")[0],o=t=>{if(!e){const l=t;l.onreadystatechange=null,l.onload=null,e=!0,0!==n.length?i():a()}},s=n.shift();s.url.constructor===String&&(s.url=[s.url]);for(let a=0;a<s.url.length;a+=1){let e;"script"===s.type?(e=document.createElement("script"),e.type="text/javascript",e.src="".concat(t).concat(s.url[a])):"stylesheet"===s.type&&(e=document.createElement("link"),e.rel="stylesheet",e.type="text/css",e.href="".concat(t).concat(s.url[a])),e.onreadystatechange=()=>{"complete"!==(void 0).readyState&&"loaded"!==(void 0).readyState||o(e)},e.onload=o,l.appendChild(e)}};i()})(e.panelInterface.deps,t.config_base,n):"__self__"===t.display_base&&n()}},X=(e,t,a,n="",i="",l=!0)=>o=>{o(G(e,t));const s="__loadDisplayObj__".concat(n,"_").concat(t,"_").concat(e),r="__loadCogData__".concat(n,"_").concat(t,"_").concat(e);window[s]=n=>{const s=n.cogInterface;o(K(e,t,n)),$(n,a,o),n.showMdDesc&&o(A(!0)),l&&(o(Y(s)),window[r]=e=>{J(s,e,n,o,i)},"jsonp"===a.data_type?C()({url:"".concat(a.display_base).concat(s.group,"/").concat(s.name,"/cogData.jsonp"),callbackName:"cdCallback",error:e=>o(Q("Couldn't load cognostics data: ".concat(e.url)))}):k({url:"".concat(a.display_base).concat(s.group,"/").concat(s.name,"/cogData.json"),callback:window[r]}).on("error",e=>o(Q("Couldn't load display list: ".concat(e.target.responseURL)))))},"jsonp"===a.data_type?C()({url:"".concat(a.display_base).concat(t,"/").concat(e,"/displayObj.jsonp"),callbackName:"ldCallback",error:e=>o(Q("Couldn't load display object: ".concat(e.url)))}):k({url:"".concat(a.display_base).concat(t,"/").concat(e,"/displayObj.json"),callback:window[s]}).on("error",e=>o(Q("Couldn't load display list: ".concat(e.target.responseURL))))};var Z=a(9);const ee=e=>e._displayList,te=e=>e.selectedDisplay&&""!==e.selectedDisplay.name&&e._displayInfo[e.selectedDisplay.name]?e._displayInfo[e.selectedDisplay.name]:{isFetching:!0,isLoaded:!1,didInvalidate:!1,info:{}},ae=e=>e.selectedDisplay,ne=e=>e._cogDataMutable,ie=e=>e.layout.pageNum?e.layout.pageNum:-1,le=e=>e.layout.nrow*e.layout.ncol,oe=e=>e.filter.state,se=e=>e.filter.view,re=e=>e.sort,ce=e=>e.layout,de=e=>e.labels,pe=e=>e._config.config,he=e=>e.appId,me=e=>e.singlePageApp,ge=e=>e.fullscreen,ue=e=>e.dialog,be=Object(Z.a)(te,e=>e.isLoaded?e.info.height/e.info.width:0),fe=Object(Z.a)(ne,oe,se,te,(e,t,a,n)=>{const i={};if(e.iface&&a.active&&e.crossfilter&&"JSON"===e.iface.type){const l=a.active;for(let a=0;a<l.length;a+=1)if("factor"===n.info.cogInfo[l[a]].type){const n=t[l[a]]&&t[l[a]].orderValue?t[l[a]].orderValue:"ct,desc";let o=[];e.groupRefs[l[a]]&&(o="ct"===n.substr(0,2)?e.groupRefs[l[a]].top(1/0):e.groupRefs[l[a]].all());const s=["ct,asc","id,desc"].indexOf(n)<0;let r=0;for(let e=0;e<o.length;e+=1)o[e].value>r&&(r=o[e].value);const c=[],d=[],p=t[l[a]]&&t[l[a]].value?t[l[a]].value:[];let h=0;for(let e=0;e<o.length;e+=1){p.indexOf(o[e].key)<0?d.push(e):(c.push(e),h+=o[e].value)}i[l[a]]={dist:o,max:r,orderValue:n,reverseRows:s,totSelected:c.length,sumSelected:h,idx:c.concat(d)}}else if("numeric"===n.info.cogInfo[l[a]].type){const t=e.groupRefs[l[a]].all();let o=0;for(let e=0;e<t.length;e+=1)t[e].value>o&&(o=t[e].value);i[l[a]]={dist:t,max:o,breaks:n.info.cogInfo[l[a]].breaks,delta:n.info.cogInfo[l[a]].delta,range:n.info.cogInfo[l[a]].range,log:n.info.cogInfo[l[a]].log}}}return i}),ve=Object(Z.a)(ne,ie,le,oe,re,(e,t,a,n,i)=>{let l=[];return e.dimensionRefs&&e.dimensionRefs.__sort&&n&&i&&(l=1===i.length?"asc"===i[0].dir?e.dimensionRefs.__sort.bottom(a,(t-1)*a):e.dimensionRefs.__sort.top(a,(t-1)*a):e.dimensionRefs.__sort.bottom(a,(t-1)*a)),l}),ye=Object(Z.a)(ne,oe,(e,t)=>void 0===e.allRef&&t?0:e.allRef.value());var we=e=>{const t=Object.keys(e);return a=>a=>n=>(-1!==t.indexOf(n.type)&&e[n.type](),a(n))};const Ee=(e,t)=>Number.isNaN(e[t]||void 0===e[t])?-9007199254740992:e[t],xe=(e,t,a)=>{const n="asc"===a?1:0;return Number.isNaN(e[t])||void 0===e[t]?9007199254740992*n:e[t]},Se=(e,t)=>e[t]?e[t]:"NA",_e=e=>{let t=1,a=e;return"!"===e[0]&&(t=-1,a=a.substr(1)),(e,n)=>(e[a]<n[a]?-1:e[a]>n[a]?1:0)*t};var Oe=e=>t=>a=>{if("SET_FILTER"===a.type&&a.filter){const t=e.getState()._cogDataMutable.crossfilter,n=e.getState()._cogDataMutable.dimensionRefs,i=e.getState()._cogDataMutable.groupRefs;if("string"===typeof a.filter||a.filter instanceof String)n[a.filter].filter(null);else{const l=Object.keys(a.filter);0===l.length&&n&&Object.keys(e.getState().filter.state).forEach(e=>n[e].filter(null));for(let o=0;o<l.length;o+=1)if("numeric"===a.filter[l[o]].varType){if(void 0===n[l[o]]&&(n[l[o]]=t.dimension(e=>Ee(e,l[o]))),void 0===i[l[o]]){const t=e.getState().selectedDisplay.name,a=e.getState()._displayInfo[t].info.cogInfo[l[o]];i[l[o]]=n[l[o]].group(e=>Number.isNaN(e)||void 0===e?null:a.breaks[Math.floor((e-a.breaks[0])/a.delta)])}if(void 0===a.filter[l[o]].value)n[l[o]].filter(null);else{let e=a.filter[l[o]].value.from,t=a.filter[l[o]].value.to;e=void 0===e?-1/0:e,t=void 0===t?1/0:t,n[l[o]].filterFunction(a=>a>=e&&a<=t)}}else if("factor"===a.filter[l[o]].varType)if(void 0===n[l[o]]&&(n[l[o]]=t.dimension(e=>Se(e,l[o]))),void 0===i[l[o]]&&(i[l[o]]=n[l[o]].group()),void 0===a.filter[l[o]].value)n[l[o]].filter(null);else{const e=a.filter[l[o]].value;n[l[o]].filter(t=>e.indexOf(t)>-1)}}}else if("SET_FILTER_VIEW"===a.type){if("add"===a.which||"set"===a.which){const t=e.getState()._cogDataMutable.crossfilter,n=e.getState()._cogDataMutable.dimensionRefs,i=e.getState()._cogDataMutable.groupRefs,l=e.getState().selectedDisplay.name;let o=[];"add"===a.which?o.push(a.name):o=a.name.active,o.forEach(a=>{const o=e.getState()._displayInfo[l].info.cogInfo[a].type;if(void 0===n[a]&&(n[a]="numeric"===o?t.dimension(e=>Ee(e,a)):t.dimension(e=>Se(e,a))),void 0===i[a])if("numeric"===o){const t=e.getState()._displayInfo[l].info.cogInfo[a];i[a]=n[a].group(e=>Number.isNaN(e)||void 0===e?null:t.breaks[Math.floor((e-t.breaks[0])/t.delta)])}else i[a]=n[a].group()})}}else if("SET_SORT"===a.type&&void 0!==a.sort){const t=e.getState()._cogDataMutable.crossfilter,n=e.getState()._cogDataMutable.dimensionRefs;if(n){n.__sort&&n.__sort.remove();let i=a.sort;if("number"===typeof a.sort&&(i=Object.assign([],[],e.getState().sort),i.splice(a.sort,1)),0===i.length)n.__sort=t.dimension(e=>e.__index);else if(1===i.length){const a=e.getState().selectedDisplay.name,l=e.getState()._displayInfo[a].info.cogInfo[i[0].name];"factor"===l.type?n.__sort=t.dimension(e=>Se(e,i[0].name)):"numeric"===l.type&&(n.__sort=t.dimension(e=>xe(e,i[0].name,i[0].dir)))}else{const a=t.all(),l=[];for(let t=0;t<a.length;t+=1){const n={__index:a[t].__index};for(let l=0;l<i.length;l+=1){const o=e.getState().selectedDisplay.name,s=e.getState()._displayInfo[o].info.cogInfo[i[l].name];"factor"===s.type?n[i[l].name]=Se(a[t],i[l].name):"numeric"===s.type&&(n[i[l].name]=xe(a[t],i[l].name,i[l].dir))}l.push(n)}const o=[];for(let e=0;e<i.length;e+=1)o.push("".concat("asc"===i[e].dir?"":"!").concat(i[e].name));l.sort((e=>{const t=e;return(e,a)=>{let n=0,i=0;for(;0===i&&n<t.length;)i=_e(t[n])(e,a),n+=1;return i}})(o));const s={};for(let e=0;e<l.length;e+=1)s[l[e].__index]=e;n.__sort=t.dimension(e=>s[e.__index])}}}return t(a)},Ce=a(8);var Ie=(e={active:""},t)=>{switch(t.type){case"ACTIVE_SIDEBAR":return Object(Ce.a)(Object(Ce.a)({},e),{},{active:t.active===e.active?"":t.active})}return e};const ke="object"===typeof window?window.innerHeight:null,Ne="object"===typeof window?window.innerWidth:null;var De=(e={windowHeight:ke,windowWidth:Ne,origHeight:void 0,origWidth:void 0},t)=>{switch(t.type){case"WINDOW_RESIZE":return Object(Ce.a)(Object(Ce.a)({},e),{},{windowHeight:t.dims.height,windowWidth:t.dims.width});case"UPDATE_DIMS":return Object(Ce.a)(Object(Ce.a)({},e),{},{origHeight:t.dims.height,origWidth:t.dims.width})}return e};var je=(e={},t)=>{switch(t.type){case"SET_PANEL_RENDERER":return Object(Ce.a)(Object(Ce.a)({},e),{},{[t.name]:{fn:t.fn}})}return e},Te=a(125),Le=a.n(Te);const Re=Object(r.c)({state:(e={},t)=>{switch(t.type){case"SET_FILTER":return"string"===typeof t.filter||t.filter instanceof String?Le()(e,t.filter):void 0===t.filter||0===Object.keys(t.filter).length&&t.filter.constructor===Object?{}:Object(Ce.a)(Object(Ce.a)({},e),t.filter)}return e},view:(e={active:[],inactive:[]},t)=>{switch(t.type){case"SET_FILTER_VIEW":{let a=Object(Ce.a)({},e);if(void 0===a.active&&(a.active=[]),void 0===a.inactive&&(a.inactive=[]),"remove"===t.which){const e=a.active.indexOf(t.name);e>-1&&a.active.splice(e,1);a.inactive.indexOf(t.name)<0&&a.inactive.push(t.name)}else if("add"===t.which){const e=a.inactive.indexOf(t.name);e>-1&&a.inactive.splice(e,1);a.active.indexOf(t.name)<0&&a.active.push(t.name)}else"set"===t.which&&(a=t.name);return a}}return e}});var Ae=(e={isFetching:!1,isLoaded:!1,didInvalidate:!1,config:{}},t)=>{switch(t.type){case"REQUEST_CONFIG":return Object(Ce.a)(Object(Ce.a)({},e),{},{isFetching:!0,isLoaded:!1,didInvalidate:!1});case"RECEIVE_CONFIG":return Object(Ce.a)(Object(Ce.a)({},e),{},{isFetching:!1,didInvalidate:!1,isLoaded:!0,config:t.config,lastUpdated:t.receivedAt});default:return e}};var ze=(e={isFetching:!1,isLoaded:!1,didInvalidate:!1,list:[]},t)=>{switch(t.type){case"REQUEST_DISPLAY_LIST":return Object(Ce.a)(Object(Ce.a)({},e),{},{isFetching:!0,isLoaded:!1,didInvalidate:!1});case"RECEIVE_DISPLAY_LIST":return Object(Ce.a)(Object(Ce.a)({},e),{},{isFetching:!1,didInvalidate:!1,isLoaded:!0,list:t.list,lastUpdated:t.receivedAt});default:return e}};var Pe=(e={},t)=>{switch(t.type){case"REQUEST_DISPLAY":return Object(Ce.a)(Object(Ce.a)({},e),{},{[t.name]:{isFetching:!0,isLoaded:!1,info:{},didInvalidate:!1}});case"RECEIVE_DISPLAY":return Object(Ce.a)(Object(Ce.a)({},e),{},{[t.name]:{isFetching:!1,didInvalidate:!1,isLoaded:!0,info:t.info,lastUpdated:t.receivedAt}});default:return e}};var Be=(e={isFetching:!1,isLoaded:!1,didInvalidate:!1},t)=>{switch(t.type){case"REQUEST_COGDATA":return Object(Ce.a)(Object(Ce.a)({},e),{},{isFetching:!0,isLoaded:!1,didInvalidate:!1});case"RECEIVE_COGDATA":return Object(Ce.a)(Object(Ce.a)({},e),{},{isFetching:!1,didInvalidate:!1,isLoaded:!0,crossfilter:t.crossfilter,dimensionRefs:{},groupRefs:{},allRef:void 0!==t.crossfilter?t.crossfilter.groupAll():void 0,iface:t.iface,lastUpdated:t.receivedAt});default:return e}};var We=(e={},t)=>{switch(t.type){case"SET_LOCAL_PANELS":return Object(Ce.a)(Object(Ce.a)({},e),t.dat)}return e};var Fe=Object(r.c)({appId:(e="app",t)=>{switch(t.type){case"SET_APP_ID":return t.id}return e},dialog:(e=!1,t)=>{switch(t.type){case"SET_DIALOG_OPEN":return t.isOpen}return e},dispSelectDialog:(e=!1,t)=>{switch(t.type){case"SET_DISPSELECT_DIALOG_OPEN":return t.isOpen}return e},dispInfoDialog:(e=!1,t)=>{switch(t.type){case"SET_DISPINFO_DIALOG_OPEN":return t.isOpen}return e},singlePageApp:(e=!0,t)=>{switch(t.type){case"SET_SINGLE_PAGE_APP":return t.singlePageApp}return e},fullscreen:(e=!0,t)=>{switch(t.type){case"SET_FULLSCREEN":return t.fullscreen}return e},ui:De,sidebar:Ie,errorMsg:(e="",t)=>{switch(t.type){case"SET_ERROR_MESSAGE":return t.msg}return e},selectedDisplay:(e={name:"",group:"",desc:""},t)=>{switch(t.type){case"SELECT_DISPLAY":return Object(Ce.a)(Object(Ce.a)({},e),{},{name:t.name,group:t.group,desc:t.desc})}return e},selectedRelDisps:(e=[],t)=>{switch(t.type){case"SET_SELECTED_RELDISPS":{const a=Object.assign([],e);if("add"===t.which)a.indexOf(t.val)<0&&a.push(t.val);else if("remove"===t.which){const e=a.indexOf(t.val);e>-1&&a.splice(e,1)}else{if("reset"===t.which)return[];if("set"===t.which)return t.val}return a.sort(),a}}return e},relDispPositions:(e=[],t)=>{switch(t.type){case"SET_REL_DISP_POSITIONS":return Object.assign([],[],t.obj)}return e},panelRenderers:je,layout:(e={nrow:1,ncol:1,arrange:"row",pageNum:1},t)=>{switch(t.type){case"SET_LAYOUT":{const a=Object(Ce.a)({},t.layout);if(a.nrow||a.ncol){const t=e.nrow*e.ncol*(e.pageNum-1)+1;a.pageNum=Math.ceil(t/(a.nrow*a.ncol)),Number.isNaN(a.pageNum)&&(a.pageNum=1)}return Object(Ce.a)(Object(Ce.a)({},e),a)}}return e},labels:(e=[],t)=>{switch(t.type){case"SET_LABELS":return Object.assign([],[],t.labels)}return e},sort:(e=[],t)=>{switch(t.type){case"SET_SORT":if("number"===typeof t.sort){const a=Object.assign([],[],e);return a.splice(t.sort,1),a}return void 0===t.sort?[]:Object.assign([],[],t.sort)}return e},filter:Re,_config:Ae,_displayList:ze,_displayInfo:Pe,_cogDataMutable:Be,_localPanels:We}),He=a(12),Me=a(11),Ue=a.n(Me),Ve=a(126),Ge=a.n(Ve),Ke=a(256),Ye=a(286),qe=a(257),Qe=a(258),Je=a(259);var $e={fontFamily:'"Open Sans", sans-serif',header:{height:48,fontSize:16,borderColor:"#eaedf0",background:"white",color:"#000",button:{color:"#9ba3af",active:{background:"#448AFF"}},logo:{background:"#FF4308",color:"white"},logoWidth:130},footer:{height:30,background:"#666666",color:"white",button:{background:"#90CAF9",color:"white"}},sideButtons:{width:48,fontSize:22,labelFontSize:11,background:"#b3b3b3",spacerBackground:"#c1c1c1",button:{color:"white",borderColor:"#c0c0c0",active:{color:"#448AFF",background:"white"},hover:{background:"#448AFF"}}},sidebar:{width:230,borderColor:"#c1c1c1",header:{fontSize:15,height:25,background:"#c1c1c1",color:"white"},filter:{margin:5,cat:{height:125,bar:{height:15,color:{default:"#eee",hover:"rgb(255, 192, 76)",select:"rgb(255, 170, 10)",noneSelect:"rgb(255, 210, 127)"}},text:{color:{default:"#888",hover:"#000",select:"#000"}}},num:{height:100,barColor:"rgb(255, 210, 127)"},variables:{height:50}}},content:{panel:{pad:2},label:{height:15,fontSize:12}},trans:{duration:"300ms",timing:"ease"}};const Xe={passoverHTML:!1,passoverAttribute:"passover",stripPassoverAttribute:!0};class Ze extends i.a.Component{constructor(...e){super(...e),this.handleOpen=()=>{const e=this.props,t=e.setDialogOpen,a=e.setThisDialogOpen;t(!0),a(!0),Ue.a.bind("esc",this.handleClose)},this.handleKey=()=>{const e=this.props,t=e.setDialogOpen,a=e.setThisDialogOpen;t(!0),a(!0),Ue.a.bind("esc",this.handleClose)},this.handleClose=()=>{const e=this.props,t=e.setDialogOpen,a=e.setThisDialogOpen;t(!1),a(!1),Ue.a.unbind("esc")}}componentDidMount(){const e=this.props,t=e.active,a=e.fullscreen;t&&a&&Ue.a.bind("i",this.handleKey)}UNSAFE_componentWillReceiveProps(e){e.active&&e.fullscreen?Ue.a.bind("i",this.handleKey):Ue.a.unbind("i")}componentWillUnmount(){const e=this.props,t=e.active,a=e.fullscreen;t&&a&&Ue.a.unbind("i")}render(){const e=this.props,t=e.classes,a=e.curDisplayInfo,n=e.singleDisplay,l=e.styles;let o="";if(a.isLoaded){const e=Ge()(a.info.mdDesc,Xe);let n="";a.info.desc&&(n=i.a.createElement("em",null,a.info.desc));const l=i.a.createElement("div",null,i.a.createElement("div",{style:{background:"#ededed",padding:5}},i.a.createElement("strong",null,a.info.name),i.a.createElement("br",null),n),i.a.createElement("p",null,"This visualization contains ".concat(a.info.n,' "panels" that you can interactively view through various controls. Each panel has a set of variables or metrics, called "cognostics", that you can use to sort and filter the panels that you want to view.')),i.a.createElement("p",null,"To learn more about how to interact with this visualization, click the \u201c?\u201d icon in the top right corner of the display."),a.info.has_inputs&&i.a.createElement("p",null,"There are user input variables available in this visualization with which you can provide feedback for any panel. These will show up as either a radio button or free text entry in the labels that show up under each panel. As you enter inputs, these are saved in your local web browser's storage and will be remembered in subsequent views of the display."),a.info.has_inputs&&i.a.createElement("p",null,"If you'd like to pull the data that you have input, you can click the \u201cExport Inputs\u201d button at the bottom left corner of the display and follow the prompts in the dialog box that pops up.")),s=this.props.isOpen;o=i.a.createElement(Ye.a,{open:s,className:"trelliscope-app",style:{zIndex:8e3,fontWeight:300},"aria-labelledby":"dialog-info-title",onBackdropClick:this.handleClose,disableEscapeKeyDown:!0,maxWidth:"md"},i.a.createElement(Ke.a,{id:"dialog-info-title"},"".concat(a.info.mdTitle)),i.a.createElement(qe.a,null,i.a.createElement("div",{className:t.modalContainer},l,i.a.createElement("div",{dangerouslySetInnerHTML:{__html:e}}))),i.a.createElement(Qe.a,null,i.a.createElement(Je.a,{color:"secondary",onClick:this.handleClose},"Close")))}return i.a.createElement("div",null,i.a.createElement("button",{type:"button",onClick:this.handleOpen,className:t.button,style:n?l.single:l.button},i.a.createElement("i",{className:"".concat(t.icon," icon-info_outline")})),o)}}const et={button:{position:"absolute",boxSizing:"border-box",top:-1,display:"inline-block",height:$e.header.height,width:$e.header.height-1,fontSize:18,paddingTop:0,color:$e.header.button.color,background:"none",textAlign:"center",borderRight:"1px solid ".concat($e.header.borderColor),borderBottom:"1px solid ".concat($e.header.borderColor),borderTop:"none",borderLeft:"none","&:hover":{transition:"background 250ms",background:"#eee",cursor:"pointer"}},icon:{paddingLeft:2,lineHeight:"".concat($e.header.height,"px")},modalContainer:{overflowY:"auto",maxHeight:520}},tt=Object(Z.a)(ae,te,ge,e=>e.dispInfoDialog,(e,t,a,n)=>({styles:{button:{left:""===e.name?-$e.sideButtons.width:$e.sideButtons.width},single:{left:""===e.name?-$e.sideButtons.width:0}},curDisplayInfo:t,fullscreen:a,active:""!==e.name,isOpen:n}));var at=Object(s.b)(e=>tt(e),e=>({setThisDialogOpen:t=>{e(A(t))}}))(Object(He.a)(et)(Ze)),nt=a(288),it=a(265),lt=a(266),ot=a(264),st=a(89),rt=a.n(st),ct=a(90),dt=a.n(ct),pt=a(148),ht=a(262),mt=a(260),gt=a(263),ut=a(261),bt=a(284),ft=a(128),vt=a.n(ft);const yt=Object(Z.a)(te,ee,(e,t)=>{const a={};if(e.isLoaded){const n=e.info.keySig,i=[e.info.group,e.info.name].join("/");t.list.forEach((e,t)=>{const l=e.keySig===n,o=[e.group,e.name].join("/");l&&o!==i&&(a[e.group]||(a[e.group]=[]),a[e.group].push(t))})}return a}),wt=e=>e.selectedRelDisps,Et=(Object(Z.a)(te,ee,wt,(e,t,a)=>{const n=[];return t.isLoaded&&e.isLoaded&&n.push({aspect:e.info.height/e.info.width,group:e.info.group,name:e.info.name}),a.forEach(e=>{n.push({aspect:t.list[e].height/t.list[e].width,group:t.list[e].group,name:t.list[e].name})}),n}),Object(Z.a)(te,e=>e.info.cogInfo?e.info.cogInfo:{})),xt=Object(Z.a)(ee,e=>{const t={};if(e.list)for(let a=0;a<e.list.length;a+=1)t[e.list[a].group]||(t[e.list[a].group]=[]),t[e.list[a].group].push(a);return t}),St=e=>e.ui.windowWidth,_t=e=>e.ui.windowHeight,Ot=e=>e.sidebar.active,Ct=Object(Z.a)(_t,e=>e-$e.header.height-$e.footer.height-$e.sidebar.header.height),It=Object(Z.a)(se,te,Ct,(e,t,a)=>{const n=e.active;if(void 0===n)return{cutoff:null,heights:[0,0]};const i=n.map(e=>{if(!t.isLoaded)return 0;if("factor"===t.info.cogInfo[e].type){const a=t.info.cogInfo[e].levels?t.info.cogInfo[e].levels.length:1e3;return Math.min($e.sidebar.filter.cat.height,15*a)+54}return"numeric"===t.info.cogInfo[e].type?$e.sidebar.filter.num.height+54:0});let l=null,o=0,s=0;for(let r=0;r<i.length;r+=1)null===l?o+i[r]>a?(l=r,s+=i[r]):o+=i[r]:s+=i[r];return null===l&&o+30+$e.sidebar.filter.variables.height>a&&(l=i.length),{cutoff:l,heights:[o,s]}}),kt=Object(Z.a)(St,Ot,It,(e,t,a)=>{const n=$e.sidebar.width*(1+("Filter Panels"===t&&a&&null!==a.cutoff));return e-$e.sideButtons.width-(""===t?0:n+1)}),Nt=Object(Z.a)(_t,e=>e-$e.header.height-$e.footer.height),Dt={container:{height:400,overflowY:"auto"},groupContainer:{display:"flex",flexWrap:"wrap",justifyContent:"space-around"},gridList:{width:700,marginBottom:24},gridTile:{cursor:"pointer"},gridTitle:{fontWeight:400,color:vt.a.A200,fontSize:15},gridSubtitle:{fontStyle:"italic",fontSize:11},img:{opacity:1,"&:hover":{opacity:.7}},titleBar:{background:"rgba(0, 0, 0, 0.8) !important"},checkbox:{position:"absolute !important",left:0,top:0,background:"rgba(69, 138, 249, 0.9) !important",color:"white !important","&checked":{color:"white !important"}},disclaimer:{paddingLeft:10,fontSize:13,marginTop:-3}},jt=Object(Z.a)(ae,wt,pe,he,Nt,kt,(e,t,a,n,i,l)=>({selectedDisplay:e,selectedRelDisps:t,appId:n,cfg:a,contentHeight:i,contentWidth:l}));var Tt=Object(s.b)(e=>jt(e),e=>({handleCheckbox:(t,a,n,i,l,o,s,r)=>{const c=a.indexOf(t)>-1,d=Object.assign([],a);if(c){const e=d.indexOf(t);e>-1&&d.splice(e,1)}else d.indexOf(t)<0&&(e(X(i[t].name,i[t].group,s,r,"",!1)),d.push(t));d.sort();const p=((e,t,a,n,i)=>{const l=[a.map(e=>e.name).indexOf(e.name),...t],o=l.length,s=n/i,r=[];for(let v=1;v<=o;v+=1)o/v===Math.floor(o/v)&&r.push([v,o/v]);const c=[],d=i*n;r.forEach((e,t)=>{const o=e[0],r=e[1],p=e[1]/e[0]*s,h=i/r,m=n/o;let g=0;for(let n=0;n<o*r;n+=1){const e=a[l[n]].height/a[l[n]].width;let t=h,i=t*e;p<e&&(i=m,t=i/e),g+=t*i}c[t]=d-g});const p=r[c.indexOf(Math.min.apply(null,c))],h=p[0],m=p[1],g=p[1]/p[0]*s,u=i/n/m,b=1/h,f=l.map((e,t)=>{const n=Math.floor(t/m),i=t%m,l=a[e].height/a[e].width;let o=u,s=o*l;return g<l&&(s=b,o=s/l),{idx:e,name:a[e].name,group:a[e].group,aspect:l,left:i*u,top:n*b,width:o,height:s,row:n,col:i}});return 1===f.length&&f[0].name===e.name?[]:f})(n,d,i,l,o);e(z({nrow:1,ncol:1})),e(U(d)),e(V(p))}}))(Object(He.a)(Dt)(({classes:e,selectable:t,di:a,displayGroups:n,handleClick:l,cfg:o,appId:s,selectedDisplay:r,selectedRelDisps:c,handleCheckbox:d,contentHeight:p,contentWidth:h})=>{const m=Object.keys(n),g=m.map(g=>{return i.a.createElement("div",{className:e.groupContainer,key:g},i.a.createElement(ht.a,{cellHeight:180,cols:3,className:e.gridList},(u=g,m.length>1?i.a.createElement(mt.a,{key:"Subheader",cols:3,style:{height:"auto"}},i.a.createElement(ut.a,{style:{fontSize:20,color:"black"},component:"div"},u)):null),n[g].map(n=>i.a.createElement(mt.a,{key:n,className:e.gridTile,onClick:()=>{t?d(n,c,r,a,p,h,o,s):l(a[n].name,a[n].group,a[n].desc)}},i.a.createElement("img",{src:"".concat(o.cog_server.info.base,"/").concat(a[n].group,"/").concat(a[n].name,"/thumb.png"),alt:a[n].name,className:e.img,key:"img".concat(n)}),t&&i.a.createElement(bt.a,{classes:{root:e.checkbox},checked:c.indexOf(n)>-1,onChange:()=>{d(n,c,r,a,p,h,o,s)},value:"checked".concat(n),inputProps:{}}),i.a.createElement(gt.a,{classes:{root:e.titleBar},title:i.a.createElement("div",{className:e.gridTitle},a[n].name.replace(/_/g," ")),subtitle:i.a.createElement("span",{style:{fontSize:13}},a[n].desc,i.a.createElement("br",null),i.a.createElement("span",{className:e.gridSubtitle},a[n].n,"\xa0panels,",a[n].updated.substring(0,a[n].updated.length-3)))}))),o.disclaimer?i.a.createElement(mt.a,{cols:o.disclaimer.cols},i.a.createElement("div",{className:e.disclaimer,dangerouslySetInnerHTML:{__html:o.disclaimer.text}})):""));var u});return i.a.createElement("div",{className:e.container},g)}));const Lt={display:"flex",alignItems:"center",justifyContent:"center",border:"solid 1px #ddd",background:"rgba(69, 138, 249, 0.4)"},Rt=e=>parseInt(e.replace("px",""),10);class At extends i.a.Component{constructor(e){super(e),this.handleOpen=()=>{(0,this.props.setDialogOpen)(!0),this.setState({open:!0}),Ue.a.bind("esc",this.handleClose)},this.handleKey=()=>{(0,this.props.setDialogOpen)(!0),this.setState({open:!0}),Ue.a.bind("esc",this.handleClose)},this.handleClose=()=>{(0,this.props.setDialogOpen)(!1),this.setState({open:!1}),Ue.a.unbind("esc")},this.setStep=e=>{this.setState({activeStep:e})},this.handleNext=()=>{this.setState({activeStep:1})},this.handleBack=()=>{this.setState({activeStep:0})},this.state={open:!1,activeStep:0}}componentDidMount(){this.props.active&&Ue.a.bind("r",this.handleKey)}UNSAFE_componentWillReceiveProps(e){e.active?Ue.a.bind("r",this.handleKey):Ue.a.unbind("r")}componentWillUnmount(){this.props.active&&Ue.a.unbind("r")}render(){const e=this.props,t=e.classes,a=e.styles,n=e.relatedDisplayGroups,l=e.displayList,o=e.contentHeight,s=e.contentWidth,r=e.selectedRelDisps,c=e.relDispPositions,d=e.handleResize,p=this.state,h=p.open,m=p.activeStep,g={position:"relative",background:"#efefef",width:s/o*400,height:400,marginLeft:"auto",marginRight:"auto"},u=[i.a.createElement(Tt,{di:l.list,displayGroups:n,handleClick:()=>{},selectable:!0}),i.a.createElement("div",{style:g},c.map(e=>i.a.createElement(pt.a,{key:e.name,style:Lt,default:{width:400*e.width,height:400*e.height,x:400*e.left,y:400*e.top},bounds:"parent",lockAspectRatio:!0,onDragStop:(t,a)=>{d(e,c,a.x,a.y,void 0,void 0,400)},onResizeStop:(t,a,n,i,l)=>{d(e,c,l.x,l.y,Rt(n.style.width),Rt(n.style.height),400)}},i.a.createElement("div",{className:t.trHandle}),i.a.createElement("div",{className:t.tlHandle}),i.a.createElement("div",{className:t.brHandle}),i.a.createElement("div",{className:t.blHandle}),e.name)))];return i.a.createElement("div",null,i.a.createElement("button",{type:"button",onClick:this.handleOpen,className:t.button,style:a.button},i.a.createElement("i",{className:"icon-open-add",style:{paddingLeft:2,lineHeight:"45px"}},i.a.createElement(ot.a,{className:t.badge,classes:{badge:t.badgeCircle},badgeContent:r.length}))),i.a.createElement(Ye.a,{open:h,className:"trelliscope-app",style:{zIndex:8e3,fontWeight:300},onBackdropClick:this.handleClose,"aria-labelledby":"dialog-reldisp-title",maxWidth:"md",fullWidth:!0},i.a.createElement(Ke.a,{id:"dialog-reldisp-title"},"View Related Displays Simultaneously"),i.a.createElement(qe.a,null,i.a.createElement("div",null,i.a.createElement(nt.a,{alternativeLabel:!0,nonLinear:!0,activeStep:m},i.a.createElement(it.a,null,i.a.createElement(lt.a,{onClick:()=>this.setStep(0)},"Select related displays (".concat(r.length," selected)"))),i.a.createElement(it.a,null,i.a.createElement(lt.a,{onClick:()=>this.setStep(1),disabled:0===m&&0===r.length},"Arrange Panel Layout"))),i.a.createElement("div",null,u[m]))),i.a.createElement(Qe.a,null,i.a.createElement("div",{style:{textAlign:"center",width:"100%"}},i.a.createElement(Je.a,{style:{width:200},onClick:()=>this.setStep(1===m?0:1),className:t.button,disabled:0===m&&0===r.length},0===m?"":i.a.createElement(rt.a,null),0===m?"Set Layout":"Select Displays",0===m?i.a.createElement(dt.a,null):"")),i.a.createElement(Je.a,{color:"secondary",onClick:this.handleClose},"Close"))))}}const zt={button:{position:"absolute",boxSizing:"border-box",top:-1,transition:"left 0.5s ease, background 250ms",display:"inline-block",height:$e.header.height,width:$e.header.height,fontSize:18,textAlign:"center",borderRight:"1px solid ".concat($e.header.borderColor),borderBottom:"1px solid ".concat($e.header.borderColor),borderLeft:"none",borderTop:"none","&:hover":{transition:"background 250ms",background:"#eee",cursor:"pointer"}},trHandle:{position:"absolute",top:0,right:0,width:8,height:8,background:"rgba(69, 138, 249, 0.4)"},tlHandle:{position:"absolute",top:0,left:0,width:8,height:8,background:"rgba(69, 138, 249, 0.4)"},brHandle:{position:"absolute",bottom:0,right:0,width:8,height:8,background:"rgba(69, 138, 249, 0.4)"},blHandle:{position:"absolute",bottom:0,left:0,width:8,height:8,background:"rgba(69, 138, 249, 0.4)"},badge:{paddingBottom:27},badgeCircle:{background:"rgba(69, 138, 249, 0.4)",color:"white"}},Pt=Object(Z.a)(ee,ae,yt,Nt,kt,wt,e=>e.relDispPositions,(e,t,a,n,i,l,o)=>({styles:{button:{left:$e.header.height*(""===t.name||0===Object.keys(a).length?0:2)-1,background:0===l.length?"none":"rgba(69, 138, 249, 0.4)",color:0===l.length?$e.header.button.color:"white"}},displayList:e,relatedDisplayGroups:a,active:Object.keys(a).length>0,contentHeight:n,contentWidth:i,selectedRelDisps:l,relDispPositions:o}));var Bt=Object(s.b)(e=>Pt(e),e=>({handleResize:(t,a,n,i,l,o,s)=>{const r=a.map(e=>e.name).indexOf(t.name),c=Object(Ce.a)({},t);c.left=n/s,c.top=i/s,l&&(c.width=l/s),o&&(c.height=o/s);const d=Object(Ce.a)({},a);d[r]=c,e(V(d))}}))(Object(He.a)(zt)(At)),Wt=a(30),Ft=a.n(Wt),Ht=a(31);class Mt extends i.a.Component{constructor(e){super(e),this.handleOpen=()=>{const e=this.props,t=e.displayList,a=e.setDialogOpen,n=e.setDispDialogOpen;t&&t.isLoaded&&(a(!0),n(!0),Ue.a.bind("esc",this.handleClose))},this.handleKey=()=>{const e=this.props,t=e.setDialogOpen,a=e.setDispDialogOpen;t(!0),a(!0),Ue.a.bind("esc",this.handleClose)},this.handleClose=()=>{const e=this.props,t=e.setDialogOpen,a=e.setDispDialogOpen;t(!1),a(!1),Ue.a.unbind("esc")},this.handleSelect=(e,t,a)=>{const n=this.props,i=n.handleClick,l=n.setDialogOpen,o=n.setDispDialogOpen;i(e,t,a,n.cfg,n.appId),l(!1),o(!1)},this.state={btnScale:1}}componentDidMount(){const e=this.props,t=e.fullscreen,a=e.selectedDisplay,n=this.state.btnScale;t&&Ue.a.bind("o",this.handleKey);const i=setInterval(()=>{const e=this._atnnCircle;""!==a.name&&clearInterval(i),e&&(e.style.transform="scale(".concat(n,")"),this.setState({btnScale:1===n?.85:1}))},750)}UNSAFE_componentWillReceiveProps(e){e.fullscreen?Ue.a.bind("o",this.handleKey):Ue.a.unbind("o")}componentWillUnmount(){this.props.fullscreen&&Ue.a.unbind("o")}render(){const e=this.props,t=e.classes,a=e.displayList,n=e.displayGroups,l=e.selectedDisplay,o=e.isOpen,s=a&&a.isLoaded;let r=i.a.createElement("div",{className:t.attnOuter},i.a.createElement("div",{className:t.attnInner},i.a.createElement("div",{ref:e=>{this._atnnCircle=e},className:t.attnEmpty})));return(""!==l.name||o)&&(r=""),i.a.createElement("div",null,i.a.createElement("button",{type:"button",onClick:this.handleOpen,className:Ft()({[t.button]:!0,[t.buttonInactive]:!s})},r,i.a.createElement("i",{className:"icon-folder-open ".concat(t.folderIcon)})),i.a.createElement(Ye.a,{open:o,className:"trelliscope-app",style:{zIndex:8e3,fontWeight:300},"aria-labelledby":"dialog-dispselect-title",onBackdropClick:this.handleClose,disableEscapeKeyDown:!0,maxWidth:"md",fullWidth:!0},i.a.createElement(Ke.a,{id:"dialog-dispselect-title"},"Select a Display to Open"),i.a.createElement(qe.a,null,i.a.createElement(Tt,{di:a.list,displayGroups:n,handleClick:this.handleSelect,selectable:!1})),i.a.createElement(Qe.a,null,i.a.createElement(Je.a,{color:"secondary",onClick:this.handleClose},"Close"))))}}const Ut={attnOuter:{position:"absolute",overflow:"hidden",height:$e.header.height,width:$e.header.height,top:0,left:($e.sideButtons.width-$e.header.height)/2,pointerEvents:"none"},attnInner:{position:"absolute",height:$e.header.height,width:$e.header.height,top:0,left:0,transition:["transform 450ms cubic-bezier(0.23, 1, 0.32, 1)","0ms opacity 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms"].join(" "),opacity:1,transform:"scale(0.85)"},attnEmpty:{position:"absolute",height:$e.header.height,width:"100%",borderRadius:"50%",opacity:.16,transition:"transform 750ms cubic-bezier(0.445, 0.05, 0.55, 0.95) 0ms",top:0,transform:"scale(0.85)",backgroundColor:"rgba(0, 0, 0, 0.870588)"},folderIcon:{paddingLeft:3},button:{zIndex:8e3,position:"absolute",boxSizing:"border-box",top:-1,left:-1,height:$e.header.height,width:$e.sideButtons.width,fontSize:18,lineHeight:"".concat($e.header.height+2,"px"),background:$e.header.button.active.background,color:"white",textAlign:"center",border:"none",transition:"all 500ms ease-in","&:hover":{transition:"background 250ms",background:Object(Ht.emphasize)($e.header.button.active.background,.2),color:"white",cursor:"pointer"}},buttonInactive:{background:"#ddd",borderColor:"#ddd","&:hover":{background:"#ccc",borderColor:"#ccc"}}},Vt=Object(Z.a)(ae,ee,xt,pe,he,me,ge,e=>e.dispSelectDialog,(e,t,a,n,i,l,o,s)=>({appId:i,cfg:n,selectedDisplay:e,displayList:t,displayGroups:a,singlePageApp:l,fullscreen:o,isOpen:s}));var Gt=Object(s.b)(e=>Vt(e),e=>({handleClick:(t,a,n,i,l)=>{var o;e(T("")),e({type:"SET_SELECTED_RELDISPS",which:"reset",val:o}),e(P([])),e(z({nrow:1,ncol:1,arrange:"row"})),e(z({pageNum:1})),e(F({active:[],inactive:[]})),e(W({})),e(B([])),e(V([])),e(M(t,a,n)),e(X(t,a,i,l,""))},setDispDialogOpen:t=>{e(R(t))}}))(Object(He.a)(Ut)(Mt)),Kt=a(201),Yt=a(129),qt=a.n(Yt),Qt=a(130),Jt=a.n(Qt);class $t extends i.a.Component{constructor(...e){super(...e),this.pageLeft=()=>{const e=this.props;let t=e.n-1;return t<1&&(t+=1),(0,e.handleChange)(t)},this.pageRight=()=>{const e=this.props;let t=e.n+1;return t>e.totPages&&(t-=1),(0,e.handleChange)(t)},this.pageFirst=()=>{(0,this.props.handleChange)(1)},this.pageLast=()=>{const e=this.props;(0,e.handleChange)(e.totPages)}}componentDidMount(){const e=this.props,t=e.fullscreen,a=e.dialogOpen;t&&(Ue.a.bind("right",()=>{a||this.pageRight()}),Ue.a.bind("left",()=>{a||this.pageLeft()}))}UNSAFE_componentWillReceiveProps(e){const t=e.dialogOpen;e.fullscreen?(Ue.a.bind("right",()=>{t||this.pageRight()}),Ue.a.bind("left",()=>{t||this.pageLeft()})):Ue.a.unbind(["right","left"])}componentWillUnmount(){this.props.fullscreen&&Ue.a.unbind(["right","left"])}render(){const e=this.props,t=e.classes,a=e.cogData,n=e.totPages,l=e.totPanels,o=e.npp,s=e.n,r={icon:{fontSize:10,padding:6},button:{width:$e.header.height-10,height:$e.header.height-10,border:0,padding:0},progress:{width:120,fontSize:14,color:"#444",lineHeight:"48px"}};if(a.isFetching||a.isLoaded&&void 0===a.crossfilter)return i.a.createElement("div",{style:r.progress},"loading panels...");if(0===l)return i.a.createElement("div",null);const c=o*(s-1)+1,d=Math.min(o*s,l);let p=i.a.createElement("span",null,c);c!==d&&(p=i.a.createElement("span",null,c,"\xa0",i.a.createElement("span",{className:t.pageDash},"-"),"\xa0",d));const h=i.a.createElement("span",null,p,i.a.createElement("span",null," of ".concat(l)));return i.a.createElement("div",{className:t.outer},i.a.createElement("div",{className:t.label},h),i.a.createElement("div",{className:t.buttonWrap},i.a.createElement("div",{className:t.buttonDiv},i.a.createElement(Kt.a,{disabled:s<=1,style:r.button,onClick:()=>this.pageFirst()},i.a.createElement(qt.a,null))),i.a.createElement("div",{className:t.buttonText},"First")),i.a.createElement("div",{className:t.buttonWrap},i.a.createElement("div",{className:t.buttonDiv},i.a.createElement(Kt.a,{disabled:s<=1,style:r.button,onClick:()=>this.pageLeft()},i.a.createElement(rt.a,null))),i.a.createElement("div",{className:t.buttonText},"Prev")),i.a.createElement("div",{className:t.buttonWrap},i.a.createElement("div",{className:t.buttonDiv},i.a.createElement(Kt.a,{disabled:s>=n,style:r.button,onClick:()=>this.pageRight()},i.a.createElement(dt.a,null))),i.a.createElement("div",{className:t.buttonText},"Next")),i.a.createElement("div",{className:t.buttonWrap},i.a.createElement("div",{className:t.buttonDiv},i.a.createElement(Kt.a,{disabled:s>=n,style:r.button,onClick:()=>this.pageLast()},i.a.createElement(Jt.a,null))),i.a.createElement("div",{className:t.buttonText},"Last")))}}const Xt={outer:{whiteSpace:"nowrap"},buttonWrap:{width:$e.header.height-10,height:$e.header.height,display:"inline-block"},buttonDiv:{width:$e.header.height-10,height:$e.header.height-10,paddingLeft:5},buttonText:{fontSize:10,width:48,height:10,lineHeight:"10px",textAlign:"center",marginTop:-5},pageDash:{display:"inline-block",transform:"scale(1.5,1)"},label:{verticalAlign:"middle",height:$e.header.height,display:"inline-block"}},Zt=Object(Z.a)(ie,ye,le,ue,ge,ne,(e,t,a,n,i,l)=>({n:e,totPanels:t,totPages:Math.ceil(t/a),npp:a,dialogOpen:n,fullscreen:i,cogData:l}));var ea=Object(s.b)(e=>Zt(e),e=>({handleChange:t=>{e(z({pageNum:t}))}}))(Object(He.a)(Xt)($t)),ta=a(281),aa=a(267);class na extends i.a.Component{constructor(e){super(e),this.handleOpen=()=>{(0,this.props.setDialogOpen)(!0),this.setState({open:!0}),Ue.a.bind("esc",this.handleClose)},this.handleChange=(e,t)=>{this.setState({value:t})},this.handleKey=()=>{(0,this.props.setDialogOpen)(!0),this.setState({open:!0}),Ue.a.bind("esc",this.handleClose)},this.handleClose=()=>{(0,this.props.setDialogOpen)(!1),this.setState({open:!1}),Ue.a.unbind("esc")},this.state={open:!1,value:0}}componentDidMount(){this.props.fullscreen&&Ue.a.bind("a",this.handleKey)}UNSAFE_componentWillReceiveProps(e){e.fullscreen?Ue.a.bind("a",this.handleKey):Ue.a.unbind("a")}componentWillUnmount(){this.props.fullscreen&&Ue.a.unbind("a")}render(){const e=this.props,t=e.classes,a=e.fullscreen,n=e.windowHeight;let l="";a||(l=i.a.createElement("p",{className:t.keynote},"Note: keyboard shortcuts are only available when the app is fullscreen."));const o=i.a.createElement("div",{className:t.dialogDiv,style:{maxHeight:Math.max(50,n-310)}},i.a.createElement("div",{className:t.dialogP},i.a.createElement("strong",null,"What: "),"Trelliscope is a tool for interactively viewing a large collection of visualizations.  Each visualization in a collection is called a\xa0",i.a.createElement("em",null,"panel"),"\xa0and each panel typically represents one slice of a large dataset."),i.a.createElement("div",{className:t.dialogP},i.a.createElement("strong",null,"Why: "),"Viewing multiple slices of a dataset simultaneously is a simple  but very powerful visual technique and provides a way to visualize data in greater detail, particularly when the dataset is large."),i.a.createElement("div",{className:t.dialogP},i.a.createElement("strong",null,"Interactivity: "),"When there are many panels, it is useful to be able to navigate to which panels you want to view and make panel-to-panel comparisons by sorting and filtering the panels based on various criteria. Trelliscope provides this interactivity through panel metrics called\xa0",i.a.createElement("em",null,"cognostics"),"."),i.a.createElement("p",null,"There are multiple modes of interaction with panels, indicated by the four buttons on the left sidebar of the application: \xa0",i.a.createElement("strong",null,"Grid"),",\xa0",i.a.createElement("strong",null,"Labels"),",\xa0",i.a.createElement("strong",null,"Filter"),",\xa0and\xa0",i.a.createElement("strong",null,"Sort"),"."),i.a.createElement("div",{className:t.dialogP},i.a.createElement("i",{className:"icon-th ".concat(t.dialogHi)}),"\xa0",i.a.createElement("strong",null,"Grid: "),'In the "Grid" sidebar, you can specify the layout of the grid of panels you wish to display, specifying the number of rows and columns of the grid, as well as whether to arrange panels in order by row or by column.'),i.a.createElement("div",{className:t.dialogP},i.a.createElement("i",{className:"icon-list-ul ".concat(t.dialogHi)}),"\xa0",i.a.createElement("strong",null,"Labels: "),'In the "Labels" sidebar, you can specify the panel metrics that you wish to see displayed under each panel visualization in the grid by clicking the checkboxes.  This can be useful for additional context along with the visualization being shown.  Note that labels can also be removed by directly hovering over the label in the grid view and clicking the "x" button that appears.  Labels are also automatically added when you specify a new variable to sort or filter on.'),i.a.createElement("div",{className:t.dialogP},i.a.createElement("i",{className:"icon-filter ".concat(t.dialogHi)}),"\xa0",i.a.createElement("strong",null,"Filter: "),'The "Filter" sidebar provides various ways to filter the panels being displayed based on the panel metrics. A list of variables is available as buttons.  Clicking a button will produce a visual distribution of the variable.',i.a.createElement("p",{className:t.dialogP2},i.a.createElement("strong",null,"Categorical filter: "),"For categorical variables, a bar chart is provided, showing the the possible values of the variable with the size of the bars relating to the count of panels available under the current filtering state of all other variables. A bar is active if its color is highlighted.  The bar chart shows active bars first followed by inactive bars. Clicking on a bar in this chart that is not active will cause only panels with the attribute of the clicked bar to be shown. Clicking on a bar that is active will remove panels with the attribute of the clicked bar from view.  Another way to specify filtering for categorical variables is to enter text into the text field below the bar chart.  Any matches to the typed text will be highlighted in the bar chart and panels will be filtered accordingly.  This field can be plain text or a\xa0",i.a.createElement("a",{href:"http://regexr.com/",target:"_blank",rel:"noopener noreferrer"},"regular expression"),"."),i.a.createElement("p",{className:t.dialogP2},i.a.createElement("strong",null,"Numeric filter: "),"For numeric variables, a histogram is provided, which shows the distribution of the variable based on all other active filters. You can click and drag left to right to highlight a range of the variable for which you would like to filter the panels. Alternatively, you can manually enter a range in the fields provided below the histogram."),i.a.createElement("p",{className:t.dialogP22},"To reset a filter variable, you can either clear out the fields, deselect the selections made in the distribution plots, or click the\xa0",i.a.createElement("i",{className:"icon-undo"}),"\xa0button located at the top right of the filter box for that variable.  This icon is only available if there is an active filter for the variable."),i.a.createElement("p",{className:t.dialogP22},"To close a filter box, click the\xa0",i.a.createElement("i",{className:"icon-times-circle"}),'\xa0button located at the top right of the filter box.  Note that if there is an active filter on the variable, its button in the "More variables" section will be green to indicate this.')),i.a.createElement("div",{className:t.dialogP},i.a.createElement("i",{className:"icon-sort-amount-asc ".concat(t.dialogHi)}),"\xa0",i.a.createElement("strong",null,"Sort: "),'In the "Sort" sidebar, a list of variables which are currently being sorted by (if any) will be listed at the top, followed by a list of "More variables" that can added to the sorting specification.  Panels are ordered primarily according to the topmost sort variable, and any subsuequent sorting variables specify secondary, tertiary, etc. sorting. For an active sortig variable, clicking the blue icon with an arrow pointing up or down will change the order of the sorting.'),i.a.createElement("div",{className:t.dialogP},"The active filter and sort state are displayed at the bottom of the page in the footer.  Clicking the\xa0",i.a.createElement("i",{className:"icon-times-circle"}),"\xa0button for anything listed in the footer will remove the sorting or filtering on that variable.")),s=i.a.createElement("div",{className:t.dialogDiv},i.a.createElement("div",null,l,i.a.createElement("div",{style:{width:"50%",display:"block",float:"left"}},i.a.createElement("h4",{className:t.dialogH4},"Sidebar controls"),i.a.createElement("ul",{className:t.dialogUl},i.a.createElement("li",null,i.a.createElement("code",{className:t.dialogCode},"g"),'\u2002open "Grid" sidebar'),i.a.createElement("li",null,i.a.createElement("code",{className:t.dialogCode},"l"),'\u2002open "Labels" sidebar'),i.a.createElement("li",null,i.a.createElement("code",{className:t.dialogCode},"f"),'\u2002open "Filter" sidebar'),i.a.createElement("li",null,i.a.createElement("code",{className:t.dialogCode},"s"),'\u2002open "Sort" sidebar'),i.a.createElement("li",null,i.a.createElement("code",{className:t.dialogCode},"esc"),"\u2002close sidebar")),i.a.createElement("h4",{className:t.dialogH4},"Panel navigation"),i.a.createElement("ul",{className:t.dialogUl},i.a.createElement("li",null,i.a.createElement("code",{className:t.dialogCode},"left"),"\u2002page back"),i.a.createElement("li",null,i.a.createElement("code",{className:t.dialogCode},"right"),"\u2002page forward"))),i.a.createElement("div",{style:{width:"50%",display:"block",float:"left"}},i.a.createElement("h4",{className:t.dialogH4},"Dialog boxes"),i.a.createElement("ul",{className:t.dialogUl},i.a.createElement("li",null,i.a.createElement("code",{className:t.dialogCode},"i"),'\u2002open "Display Info" dialog'),i.a.createElement("li",null,i.a.createElement("code",{className:t.dialogCode},"a"),'\u2002open "About" dialog'),i.a.createElement("li",null,i.a.createElement("code",{className:t.dialogCode},"esc"),"\u2002close dialog")),i.a.createElement("h4",{className:t.dialogH4},"Touchscreen devices"),i.a.createElement("p",{className:t.dialogUl},"Swiping left and right will page the panels forward and backward")))),r=i.a.createElement("div",{className:t.dialogDiv},i.a.createElement("p",null,"\xa9\xa0",i.a.createElement("a",{href:"http://ryanhafen.com",target:"_blank",rel:"noopener noreferrer"},"Ryan Hafen"),", 2019."),i.a.createElement("p",null,"Built with\xa0",i.a.createElement("a",{href:"https://facebook.github.io/react/",target:"_blank",rel:"noopener noreferrer"},"React"),"\xa0and several other awesome libraries listed\xa0",i.a.createElement("a",{href:"https://github.com/hafen/trelliscopejs-lib/blob/master/package.json",target:"_blank",rel:"noopener noreferrer"},"here"),"."),i.a.createElement("p",null,"Source code available on\xa0",i.a.createElement("a",{href:"https://github.com/hafen/trelliscopejs-lib/",target:"_blank",rel:"noopener noreferrer"},"github"),"\xa0\u2013 submit issues and feature requests there."),i.a.createElement("p",null,"Thanks to Bill Cleveland for ideas upon which this is built, to Saptarshi Guha for creating a multi-panel plot viewer prototype many years ago that inspired initial work, and to Barret Schloerke for the introduction to React and discussions about the interface.")),c=this.state,d=c.open,p=c.value;return i.a.createElement("div",null,i.a.createElement("button",{type:"button",onClick:this.handleOpen,className:t.logo},"Trelliscope",i.a.createElement("div",{className:t.icon},i.a.createElement("i",{className:"icon-help ".concat(t.icon)}))),i.a.createElement(Ye.a,{open:d,className:"trelliscope-app",style:{zIndex:8e3,fontWeight:300},"aria-labelledby":"dialog-viewer-title",onBackdropClick:this.handleClose},i.a.createElement(Ke.a,{id:"dialog-viewer-title"},"Trelliscope Viewer v".concat("0.3.4")),i.a.createElement(qe.a,null,i.a.createElement(ta.a,{value:p,onChange:this.handleChange},i.a.createElement(aa.a,{label:"How to Use"}),i.a.createElement(aa.a,{label:"Shortcuts"}),i.a.createElement(aa.a,{label:"Credits"})),0===p&&o,1===p&&s,2===p&&r),i.a.createElement(Qe.a,null,i.a.createElement(Je.a,{color:"secondary",onClick:this.handleClose},"Close"))))}}const ia={logo:{position:"absolute",top:-1,right:0,cursor:"pointer",border:"none",height:$e.header.height,textAlign:"center",width:$e.header.logoWidth,fontSize:17,background:$e.header.logo.background,color:$e.header.logo.color},icon:{position:"absolute",top:1,right:1,color:Object(Ht.emphasize)($e.header.logo.background,.4)},dialogHeadline:{fontSize:24,paddingTop:16,marginBottom:12,fontWeight:400},dialogDiv:{fontSize:18,paddingLeft:10,paddingRight:10,zIndex:5e3},dialogH4:{marginBottom:5},dialogUl:{marginTop:0,breakInside:"avoid-column"},dialogCode:{color:"#FF5252",fontSize:20},dialogP:{textIndent:-20,paddingLeft:20,marginTop:"1em"},dialogP2:{paddingLeft:20},dialogP22:{textIndent:0,paddingLeft:20},dialogHi:{color:"#FF5252"},keynote:{marginBottom:0,color:"#888",fontStyle:"italic"}},la=Object(Z.a)(_t,ge,(e,t)=>({windowHeight:e,fullscreen:t}));var oa=Object(s.b)(e=>la(e))(Object(He.a)(ia)(na));class sa extends i.a.Component{constructor(e){super(e),this.state={singleLoaded:""!==e.selectedDisplay.name,singleDisplay:e.displayList.isLoaded&&e.displayList.list.length<=1}}UNSAFE_componentWillReceiveProps(e){const t=this.state.singleLoaded,a=e.displayList.isLoaded&&e.displayList.list.length<=1;this.setState({singleDisplay:a}),!t&&a&&""!==e.selectedDisplay.name?this.setState({singleLoaded:!0}):!t&&a&&(e.selectDisplay(e.displayList.list[0].name,e.displayList.list[0].group,e.displayList.list[0].desc,e.cfg,e.appId,window.location.hash),this.setState({singleLoaded:!0}))}render(){const e=this.props,t=e.classes,a=e.styles,n=e.displayList,l=e.selectedDisplay,o=e.relatedDisplayGroups,s=e.displayGroups,r=e.doSetDialogOpen,c=e.dialogOpen,d=this.state.singleDisplay;let p="",h="",m={visibility:"hidden"},g="",u="",b="";o&&Object.keys(o).length>0&&(b=i.a.createElement(Bt,{setDialogOpen:r}));const f=""!==l.name,v=Object.keys(s).length;return n.isLoaded&&!d&&(u=i.a.createElement(Gt,{setDialogOpen:r})),f?(p=v>1?"".concat(l.group," /\n          ").concat(l.name):l.name.replace(/_/g," "),d||(m={color:"#aaa",fontSize:12}),h=l.desc,g=i.a.createElement(ea,null)):d?p="loading...":!c&&n.list.length>0&&(p=i.a.createElement("span",null,i.a.createElement("i",{className:"icon-arrow-left"}),"\xa0select a display to view...")),i.a.createElement("div",{className:t.headerContainer,style:a.headerContainer},u,b,i.a.createElement(at,{singleDisplay:d,setDialogOpen:r}),i.a.createElement("i",{style:m,className:"fa fa-info-circle"}),i.a.createElement("div",{className:t.headerSubContainer,style:a.headerSubContainer},i.a.createElement("div",{className:t.nameDescContainer},i.a.createElement("div",{className:t.displayName,style:a.displayName},p),i.a.createElement("div",{className:t.displayDesc},h)),i.a.createElement("div",{className:t.paginationContainer},g)),i.a.createElement(oa,{setDialogOpen:r,singleDisplay:d}))}}const ra={headerContainer:{position:"absolute",boxSizing:"border-box",top:0,left:0,height:$e.header.height,background:$e.header.background,color:$e.header.color,borderBottom:"1px solid ".concat($e.header.borderColor),borderTop:"1px solid ".concat($e.header.borderColor),borderLeft:"1px solid ".concat($e.header.borderColor),margin:0,fontSize:$e.header.fontSize,fontWeight:300,zIndex:1010},headerSubContainer:{display:"flex",position:"absolute",top:0,height:$e.header.height},nameDescContainer:{flex:"1 0",minWidth:0,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},paginationContainer:{},displayName:{verticalAlign:"top",paddingLeft:15,fontSize:17,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},displayDesc:{verticalAlign:"top",fontWeight:300,paddingLeft:15,paddingRight:8,fontSize:10,fontStyle:"italic",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"}},ca=Object(Z.a)(he,St,ee,xt,ae,yt,pe,ue,(e,t,a,n,i,l,o,s)=>({styles:{headerContainer:{width:t},headerSubContainer:{left:$e.header.height*((a.list.length<=1?0:1)+(""===i.name?0:1)+(0===Object.keys(l).length?0:1)),width:t-($e.header.height*((a.list.length<=1?0:1)+(""===i.name?0:1)+(0===Object.keys(l).length?0:1))+$e.header.logoWidth+30)},displayName:{lineHeight:"".concat(""===i.desc?48:26,"px"),paddingTop:""===i.desc?0:5}},appId:e,cfg:o,displayList:a,displayGroups:n,selectedDisplay:i,relatedDisplayGroups:l,dialogOpen:s}));var da=Object(s.b)(e=>ca(e),e=>({selectDisplay:(t,a,n,i,l,o)=>{e(M(t,a,n)),e(X(t,a,i,l,o))},doSetDialogOpen:t=>{e(L(t))}}))(Object(He.a)(ra)(sa));a(189);const pa={base:{position:"relative",width:$e.sideButtons.width,height:$e.sideButtons.width,lineHeight:"".concat($e.sideButtons.width,"px"),textAlign:"center",verticalAlign:"middle",fontSize:$e.sideButtons.fontSize,color:$e.sideButtons.button.color,borderBottom:"1px solid ".concat($e.sideButtons.button.borderColor),borderTop:"none",borderLeft:"none",borderRight:"none",userSelect:"none",background:$e.sideButtons.background,transition:"color 0.2s, background 0.2s","&:hover":{transition:"color 0.2s, background 0.2s",background:$e.sideButtons.button.hover.background,cursor:"pointer"}},active:{transition:"color 0.2s, background 0.2s",background:"white",color:$e.sideButtons.button.active.color,"&:hover":{transition:"color 0.2s, background 0.2s",background:$e.sideButtons.button.active.background}},icon:{lineHeight:"".concat($e.sideButtons.fontSize,"px"),height:$e.sideButtons.fontSize,width:$e.sideButtons.width,position:"absolute",top:8,left:0},label:{fontSize:$e.sideButtons.labelFontSize,lineHeight:"".concat($e.sideButtons.labelFontSize,"px"),width:$e.sideButtons.width,position:"absolute",bottom:4,left:0},bottom:{position:"absolute",bottom:0,left:0,borderTop:"1px solid",borderBottom:"0px"}};var ha=Object(He.a)(pa)(({classes:e,isActive:t,icon:a,title:n,label:l,onClick:o})=>i.a.createElement("button",{className:Ft()({[e.base]:!0,[e.active]:t,[e.bottom]:"Configuration"===n}),type:"button",onClick:o},i.a.createElement("div",{className:e.icon},i.a.createElement("i",{className:a})),i.a.createElement("div",{className:e.label},l)));const ma=[{icon:"icon-th",label:"Grid",title:"Panel Grid Layout",key:"g"},{icon:"icon-list-ul",label:"Labels",title:"Show/Hide Labels",key:"l"},{icon:"icon-filter",label:"Filter",title:"Filter Panels",key:"f"},{icon:"icon-sort-amount-asc",label:"Sort",title:"Sort Panels",key:"s"},{icon:"icon-views",label:"Views",title:"Views",key:"v"}];class ga extends i.a.Component{constructor(e){super(e),this.handleKey=(e,t)=>{const a=this.props,n=a.dialogOpen,i=a.setActive,l=a.hasViews;if("v"!==t||l)if("INPUT"===e.target.nodeName||n)e.stopPropagation();else if("esc"===t||"enter"===t)i("");else{const e=[];for(let a=0;a<ma.length;a+=1)ma[a].key===t&&e.push(ma[a].title);e.length>0&&i(e[0])}},this.state={}}componentDidMount(){const e=this.props,t=e.fullscreen,a=e.active;t&&(Ue.a.bind(["g","l","f","s","c","v","enter"],this.handleKey),""!==a&&Ue.a.bindGlobal("esc",this.handleKey))}UNSAFE_componentWillReceiveProps(e){e.fullscreen?(Ue.a.bind(["g","l","f","s","c","v","enter"],this.handleKey),""!==e.active&&Ue.a.bindGlobal("esc",this.handleKey)):Ue.a.unbind(["g","l","f","s","c","v","esc","enter"])}componentWillUnmount(){this.props.fullscreen&&Ue.a.unbind(["g","l","f","s","c","v","esc","enter"])}render(){const e=this.props,t=e.classes,a=e.styles,n=e.active,l=e.hasViews,o=e.setActive;return i.a.createElement("div",{className:t.sideButtonsContainer,style:a.sideButtonsContainer},i.a.createElement("div",{className:t.spacer}),ma.map(e=>"Views"!==e.label||l?i.a.createElement(ha,{key:"sidebutton_".concat(e.title),isActive:e.title===n,icon:e.icon,title:e.title,label:e.label,onClick:()=>o(e.title)}):""))}}const ua={sideButtonsContainer:{position:"absolute",left:0,top:0,paddingTop:$e.header.height,width:$e.sideButtons.width,background:$e.sideButtons.background,boxSizing:"border-box",zIndex:1e3},spacer:{transition:"height 0.2s",height:$e.sidebar.header.height,width:$e.sideButtons.width,background:$e.sideButtons.spacerBackground}},ba=Object(Z.a)(Nt,Ot,ue,ge,te,(e,t,a,n,i)=>({styles:{sideButtonsContainer:{height:e+$e.header.height}},width:$e.sideButtons.width,active:t,dialogOpen:a,fullscreen:n,hasViews:i.info&&i.info.views&&i.info.views.length>0||!1}));var fa=Object(s.b)(e=>ba(e),e=>({setActive:t=>{e(T(t))}}))(Object(He.a)(ua)(ga)),va=a(268),ya=a(202),wa=a(269);const Ea=Object(Z.a)(Nt,de,te,(e,t,a)=>({width:$e.sidebar.width,height:e-$e.sidebar.header.height,labels:t,cogInfo:a.info.cogInfo}));var xa=Object(s.b)(e=>Ea(e),e=>({handleChange:(t,a)=>{const n=a.indexOf(t);-1===n?a.push(t):a.splice(n,1),e(P(a))}}))(Object(He.a)({rowDesc:{color:"#888",fontStyle:"italic"}})(({height:e,labels:t,cogInfo:a,handleChange:n})=>{let l=i.a.createElement("div",null);const o=Object.keys(a);if(o.length>0){const s=o.map(e=>({name:a[e].name,desc:a[e].desc}));l=i.a.createElement("div",{style:{height:e,overflowY:"auto",overflowX:"hidden"}},i.a.createElement(va.a,{style:{padding:0}},s.map(e=>i.a.createElement(ya.a,{key:e.name,dense:!0,button:!0,onClick:()=>n(e.name,t)},i.a.createElement(bt.a,{checked:-1!==t.indexOf(e.name),style:{width:20,height:20},tabIndex:-1,disableRipple:!0}),i.a.createElement(wa.a,{primary:e.name,secondary:e.desc,style:{whiteSpace:"nowrap",textOverflow:"ellipsis"}})))))}return l})),Sa=a(282),_a=a(287),Oa=a(271),Ca=a(270);class Ia extends i.a.Component{constructor(e){super(e),this.increment=()=>{const e=this.state,t=e.value,a=e.step,n=this.props,i=n.max,l=n.onChange,o=t+a;i&&o>i||(this.setState({value:o}),l&&l(o))},this.decrement=()=>{const e=this.state,t=e.value,a=e.step,n=this.props,i=n.min,l=n.onChange,o=t-a;i&&o<i||(this.setState({value:o}),l&&l(o))},this.handleChange=e=>{const t=this.props,a=t.min,n=t.max,i=t.onChange;this.setState({value:e.target.value});const l=parseFloat(e.target.value);if(!Number.isNaN(l)&&i){let e=!0;a&&l<a&&(e=!1),n&&l>n&&(e=!1),e&&i(l)}};let t=1;e.step&&(t=e.step),this.state={value:e.value,step:t},this.mousetrap=null}componentDidMount(){this.mousetrap=new Ue.a(this._NumericInput),this.mousetrap.bind("up",()=>this.increment()),this.mousetrap.bind("down",()=>this.decrement()),this.mousetrap.bind("esc",()=>(this._NumericInput.blur(),!1)),this.mousetrap.bind(["left","right","g","l","s","f","c","a","i","o","r"],e=>e.stopPropagation())}UNSAFE_componentWillReceiveProps(e){this.setState({value:e.value})}componentWillUnmount(){this.mousetrap.unbind("up"),this.mousetrap.unbind("down"),this.mousetrap.unbind("esc"),this.mousetrap.unbind(["left","right","g","l","s","f","c","a","i","o","r"])}render(){const e=this.props,t=e.classes,a=e.arrows,n=e.size,l=this.state.value;let o="";return a&&(o=i.a.createElement("span",null,i.a.createElement("button",{type:"button",key:"up-button",className:"".concat(t.b," ").concat(t.b1),onClick:this.increment,tabIndex:"-1"},i.a.createElement("i",{className:"".concat(t.i," ").concat(t.i1)})),i.a.createElement("button",{type:"button",key:"down-button",className:"".concat(t.b," ").concat(t.b2),onClick:this.decrement,tabIndex:"-1"},i.a.createElement("i",{className:"".concat(t.i," ").concat(t.i2)})))),i.a.createElement("span",{className:t.span},i.a.createElement("input",{ref:e=>{this._NumericInput=e},type:"text",size:n||4,className:"mousetrap ".concat(t.input),value:l,onChange:this.handleChange}),o)}}const ka={span:{position:"relative",display:"inline-block",borderRadius:0,fontSize:13},input:{padding:"3px 10px 3px 6px",boxSizing:"border-box",height:28,width:"auto",fontSize:15,borderRadius:2,fontFamily:$e.fontFamily,border:"1px solid rgb(204, 204, 204)",display:"block",lineHeight:"normal"},b:{position:"absolute",right:2,width:15,borderColor:"rgba(0, 0, 0, 0.0980392)",borderStyle:"solid",textAlign:"center",cursor:"pointer",transition:"all 0.1s",boxShadow:"none","&:hover":{background:"rgba(0, 0, 0, 0.2)",boxShadow:"0 0 0 0.5px rgba(0, 0, 0, 0.3)"}},b1:{top:2,bottom:"50%",borderRadius:"2px 2px 0px 0px",borderWidth:"1px 1px 0px",background:"rgba(0, 0, 0, 0.0980392)",height:12},b2:{top:"50%",bottom:2,borderRadius:"0px 0px 2px 2px",borderWidth:"0px 1px 1px",background:"rgba(0, 0, 0, 0.0980392)",height:12},i:{position:"absolute",top:"50%",left:"50%",width:0,height:0},i1:{borderWidth:"0px 0.6ex 0.6ex",borderColor:"transparent transparent rgba(0, 0, 0, 0.701961)",borderStyle:"solid",margin:"-0.3ex 0px 0px -0.56ex"},i2:{borderWidth:"0.6ex 0.6ex 0px",borderColor:"rgba(0, 0, 0, 0.701961) transparent transparent",borderStyle:"solid",margin:"-0.3ex 0px 0px -0.56ex"}};var Na=Object(He.a)(ka)(Ia);const Da={row:{paddingLeft:15,paddingRight:15,paddingTop:8,paddingBottom:6,height:42,boxSizing:"border-box",fontSize:16,width:$e.sidebar.width,display:"inline-block"},label:{lineHeight:"28px",float:"left"},nInput:{float:"right"},inputRadio:{marginBottom:5,marginTop:0},inputLabelSpan:{lineHeight:"40px",verticalAlign:"middle",fontSize:16},inputIcon:{fontSize:23,paddingLeft:6,verticalAlign:"text-bottom"},relDisp:{fontSize:14,padding:15},relDispText:{paddingBottom:10},relDispButton:{textAlign:"center"}},ja=Object(Z.a)(ce,e=>e.selectedRelDisps,(e,t)=>({layout:e,hasRelDisps:t.length>0}));var Ta=Object(s.b)(e=>ja(e),e=>({handleChange:t=>{e(z(t))},resetRelDisps:()=>{e(U([])),e(V([]))}}))(Object(He.a)(Da)(({classes:e,layout:t,hasRelDisps:a,handleChange:n,resetRelDisps:l})=>{let o=i.a.createElement("div",null);return a?o=i.a.createElement("div",{className:e.relDisp},i.a.createElement("div",{className:e.relDispText},"Grid layout cannot be changed when viewing related displays."),i.a.createElement("div",{className:e.relDispButton},i.a.createElement(Je.a,{variant:"outlined",color:"primary",onClick:l,size:"small"},"Remove Related Displays"))):t.nrow&&(o=i.a.createElement("div",null,i.a.createElement("div",{className:e.row},i.a.createElement("div",{className:e.label},"Rows:"),i.a.createElement("div",{className:e.nInput},i.a.createElement(Na,{arrows:!0,value:t.nrow,size:3,min:1,max:15,step:1,onChange:e=>n({nrow:e,ncol:t.ncol,arrange:t.arrange})}))),i.a.createElement(Ca.a,null),i.a.createElement("div",{className:e.row},i.a.createElement("div",{className:e.label},"Columns:"),i.a.createElement("div",{className:e.nInput},i.a.createElement(Na,{arrows:!0,value:t.ncol,size:3,min:1,max:15,step:1,onChange:e=>n({nrow:t.nrow,ncol:e,arrange:t.arrange})}))),i.a.createElement(Ca.a,null),i.a.createElement("div",{className:e.row},"Arrangement:"),i.a.createElement("div",{className:e.row},i.a.createElement(_a.a,{name:"arrangement",value:t.arrange,onChange:(e,a)=>n({nrow:t.nrow,ncol:t.ncol,arrange:a})},i.a.createElement(Oa.a,{value:"row",control:i.a.createElement(Sa.a,null),label:i.a.createElement("span",{className:e.inputLabelSpan},"By row",i.a.createElement("i",{className:"icon-byrow ".concat(e.inputIcon)})),className:e.inputRadio}),i.a.createElement(Oa.a,{value:"column",control:i.a.createElement(Sa.a,null),label:i.a.createElement("span",{className:e.inputLabelSpan},"By column",i.a.createElement("i",{className:"icon-bycol ".concat(e.inputIcon)})),className:e.inputRadio}))))),o})),La=a(59),Ra=a(272);const Aa={tableWrap:{overflowY:"auto",overflowX:"hidden"},table:{width:$e.sidebar.width-5,borderCollapse:"collapse",borderSpacing:0,tableLayout:"fixed"},tr:{width:$e.sidebar.width-5,height:48,borderBottom:"1px solid rgb(224, 224, 224)"},sortButton:{verticalAlign:"middle",width:45,textAlign:"center"},labels:{fontSize:13,height:48,width:$e.sidebar.width-45-45-5,verticalAlign:"middle",overflow:"hidden",whiteSpace:"nowrap",textOverflow:"ellipsis"},closeButton:{height:48,width:45,textAlign:"center",verticalAlign:"middle"},notUsedHeader:{height:30,lineHeight:"30px",paddingLeft:10,boxSizing:"border-box",width:$e.sidebar.width,fontSize:14},notUsed:{width:$e.sidebar.width,overflowY:"auto",boxSizing:"border-box",paddingLeft:10,paddingRight:10,paddingBottom:10},variable:{display:"inline-block",boxShadow:"rgba(0, 0, 0, 0.117647) 0px 1px 6px, rgba(0, 0, 0, 0.117647) 0px 1px 4px",borderRadius:10,border:0,background:"none",paddingTop:"2px !important",paddingBottom:"3px !important",paddingLeft:"7px !important",paddingRight:"7px !important",margin:"3px !important",fontSize:12,color:"black",cursor:"pointer",transition:"all 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms","&:hover":{transition:"all 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms",background:"#ebebeb"}}},za=Object(Z.a)(te,e=>{const t={},a=Object.keys(e.info.cogInfo);for(let n=0;n<a.length;n+=1)t[a[n]]=e.info.cogInfo[a[n]].desc;return t}),Pa=Object(Z.a)(re,za,Ct,de,(e,t,a,n)=>{const i=51*e.length>a-102;let l=51*e.length;if(i){l=51*Math.ceil(.6*a/51)-25}return{styles:{tableWrap:{maxHeight:l},notUsed:{height:a-l-30}},sort:e,cogDesc:t,labels:n}});var Ba=Object(s.b)(e=>Pa(e),e=>({handleChange:t=>{e(B(t)),e(z({pageNum:1}))},addLabel:(t,a)=>{if(a.indexOf(t)<0){const n=Object.assign([],a);n.push(t),e(P(n))}}}))(Object(He.a)(Aa)(({classes:e,styles:t,sort:a,cogDesc:n,labels:l,handleChange:o,addLabel:s})=>{let r=i.a.createElement("div",null);if(n){const c=Object.keys(n);for(let e=0;e<a.length;e+=1){const t=c.indexOf(a[e].name);t>-1&&c.splice(t,1)}r=i.a.createElement("div",null,i.a.createElement("div",{className:e.tableWrap,style:t.tableWrap},i.a.createElement("table",{className:e.table},i.a.createElement("tbody",null,a.map((t,l)=>{const s="asc"===t.dir?"up":"down";return i.a.createElement("tr",{className:e.tr,key:"".concat(t.name,"_tr")},i.a.createElement("td",{className:e.sortButton},i.a.createElement(Kt.a,{color:"primary",key:"".concat(t.name,"_button"),onClick:()=>{const e=Object.assign([],a);e[l].dir="asc"===e[l].dir?"desc":"asc",o(e)}},i.a.createElement("i",{className:"icon-chevron-".concat(s),style:{fontSize:16}}))),i.a.createElement("td",{className:e.labels},t.name,i.a.createElement("br",null),i.a.createElement("span",{style:{color:"#888",fontStyle:"italic"}},n[t.name])),i.a.createElement("td",{className:e.closeButton},i.a.createElement(Kt.a,{onClick:()=>o(l)},i.a.createElement(Ra.a,{className:"icon-times",style:{fontSize:16,color:"#aaa"}}))))})))),i.a.createElement("div",{className:e.notUsedHeader},0===a.length?"Select a variable to sort on:":0===c.length?"":"More variables:"),i.a.createElement("div",{className:e.notUsed,style:t.notUsed},c.map(t=>i.a.createElement("span",{key:"".concat(t,"_notused")},i.a.createElement("span",{"data-tip":!0,"data-for":"tooltip_".concat(t)},i.a.createElement("button",{type:"button",className:e.variable,key:"".concat(t,"_button"),onClick:()=>{const e=Object.assign([],a);e.push({name:t,dir:"asc"}),s(t,l),o(e)}},t)),i.a.createElement(La.a,{place:"right",id:"tooltip_".concat(t)},i.a.createElement("span",null,n[t]))))))}return r})),Wa=a(131),Fa=a.n(Wa),Ha=a(149),Ma=a(274),Ua=a(280),Va=a(134),Ga=a.n(Va),Ka=a(144);class Ya extends i.a.Component{constructor(e){super(e),this.mouseOver=()=>{this.setState({hover:!0})},this.mouseOut=()=>{this.setState({hover:!1})},this.state={hover:!1}}render(){const e=this.props,t=e.classes,a=e.width,n=e.height,l=e.d,o=e.divStyle,s=e.handleClick,r=e.active,c=e.allActive,d=this.state.hover,p=Math.min(10,n-6),h=Math.min(9,n-7),m=l.ct===l.mct?l.mct:"".concat(l.ct," / ").concat(l.mct);return i.a.createElement("div",{className:Ft()({[t.wrapper]:!0,[t.wrapperHover]:d}),style:o,onMouseOver:this.mouseOver,onFocus:this.mouseOver,onMouseOut:this.mouseOut,onBlur:this.mouseOut,onClick:s},i.a.createElement("div",{className:Ft()({[t.bar]:!0,[t.barHover]:d,[t.barActive]:r&&!d,[t.barAllActive]:c&&!d}),style:{width:a,height:n-1}},i.a.createElement("div",{className:t.barText,style:{fontSize:p,lineHeight:"".concat(n-1,"px"),width:a}},i.a.createElement("div",{className:t.barTextInner},l.id))),i.a.createElement("div",{className:Ft()({[t.barLabel]:!0,[t.hidden]:!d}),style:{labelFontSize:h,lineHeight:"".concat(n-1,"px")}},m))}}const qa={wrapper:{background:"white"},wrapperHover:{background:"#f6f6f6"},bar:{background:$e.sidebar.filter.cat.bar.color.default,color:$e.sidebar.filter.cat.text.color.default,position:"absolute",left:0},barHover:{background:$e.sidebar.filter.cat.bar.color.hover,color:$e.sidebar.filter.cat.text.color.hover},barActive:{background:$e.sidebar.filter.cat.bar.color.select,color:$e.sidebar.filter.cat.text.color.select},barAllActive:{background:$e.sidebar.filter.cat.bar.color.noneSelect,color:$e.sidebar.filter.cat.text.color.select},barLabel:{fontSize:10,color:"#444",textAlign:"center",cursor:"default",position:"absolute",lineHeight:"19px",right:4},hidden:{visibility:"hidden"},barText:{display:"inline-block",overflow:"hidden",cursor:"default"},barTextInner:{display:"inline-block",whiteSpace:"nowrap",position:"absolute",left:5,bottom:0}};var Qa=Object(He.a)(qa)(Ya);class Ja extends i.a.Component{constructor(...e){super(...e),this.barCellRenderer=e=>{const t=this.props,a=t.condDist,n=t.sortOrder,l=t.filterState,o=t.cellHeight,s=t.width,r=t.dist;let c=0,d=0,p="",h=0,m=!0;const g=a.totSelected;let u;return u=e.rowIndex<g?a.reverseRows?e.rowIndex:g-(e.rowIndex+1):a.reverseRows?e.rowIndex:a.dist.length-(e.rowIndex-g+1),u=a.idx[u],m=e.rowIndex<g,c=a.dist[u].value,d=c,p=a.dist[u].key,h=a.max,i.a.createElement(Qa,{key:"".concat(e.rowIndex,"_").concat(d,"_").concat(n),style:null,divStyle:e.style,active:m,allActive:void 0===l.value,height:o,width:c/h*(s-1)+1,handleClick:()=>this.handleSelect(p,m),d:{ct:d,mct:r.dist[p],id:p}})}}handleSelect(e,t){const a=this.props,n=a.filterState,i=a.sortOrder,l=a.handleChange,o=Object.assign([],n.value);if(t){const t=o.indexOf(e);t>-1&&o.splice(t,1)}else o.push(e);let s={};s=0===o.length?{name:n.name,varType:n.varType,orderValue:i}:{name:n.name,type:"select",varType:n.varType,value:o,orderValue:i},l(s)}render(){const e=this.props,t=e.condDist,a=e.filterCardinality,n=e.width,l=e.height,o=e.cellHeight,s=t.orderValue,r=t.totSelected,c=t.sumSelected,d=a;return i.a.createElement(Ka.a,{key:"".concat(s,"_").concat(r,"_").concat(c,"_").concat(d),width:n,height:l,columnWidth:n,rowHeight:o,columnCount:1,rowCount:t.dist.length,cellRenderer:this.barCellRenderer})}}const $a=Object(Z.a)(ye,e=>({filterCardinality:e}));var Xa=Object(s.b)(e=>$a(e))(Ja);const Za=[{payload:"ct,asc",text:"Order: count ascending"},{payload:"ct,desc",text:"Order: count descending"},{payload:"id,asc",text:"Order: label ascending"},{payload:"id,desc",text:"Order: label descending"}];class en extends i.a.Component{constructor(e){super(e),this.handleMenuClose=()=>{this.setState({menuOpen:!1})},this.handleMenuIconClick=e=>{const t=this.state.menuOpen;this.setState({menuOpen:!t}),this.setState({anchorEl:t?null:e.currentTarget})};const t=this.props.filterState;this.sortOrder=t.orderValue?t.orderValue:"ct,desc",this.state={menuOpen:!1,anchorEl:null}}UNSAFE_componentWillUpdate(){const e=this.props.filterState;this.sortOrder=e.orderValue?e.orderValue:"ct,desc"}handleRegex(e){const t=this.props,a=t.filterState,n=t.levels,i=t.handleChange;let l={};if(""===e)l={name:a.name,varType:a.varType,orderValue:this.sortOrder};else{const t=[],i=new RegExp(e,"i");n.forEach(e=>{null!==e.match(i)&&t.push(e)}),l={name:a.name,type:"regex",varType:a.varType,regex:e,value:t,orderValue:this.sortOrder}}i(l)}render(){const e=this.props,t=e.classes,a=e.handleSortChange,n=e.filterState,l=e.height,o=e.dist,s=e.condDist,r=e.handleChange,c={width:$e.sidebar.width-40,marginTop:-8,fontSize:16,transform:"scale(0.85)",transformOrigin:"0 0"},d=this.state,p=d.menuOpen,h=d.anchorEl,m=i.a.createElement("div",{className:t.extraOptionsInput},i.a.createElement(Kt.a,{"aria-label":"more","aria-controls":"long-menu","aria-haspopup":"true",onClick:this.handleMenuIconClick},i.a.createElement(Ga.a,null)),i.a.createElement(Ha.a,{id:"long-menu",open:p,anchorEl:h,onClose:this.handleMenuClose},Za.map(e=>i.a.createElement(Ma.a,{key:e.payload,selected:e.payload===n.orderValue,onClick:()=>{a(Object.assign(n,{orderValue:e.payload})),this.handleMenuClose()}},e.text))));return i.a.createElement("div",{className:t.container},i.a.createElement("div",{className:t.plotContainer},i.a.createElement(Xa,{className:t.plotContainer,height:l,width:$e.sidebar.width-2*$e.sidebar.filter.margin,cellHeight:15,dist:o,condDist:s,filterState:n,handleChange:r,sortOrder:this.sortOrder})),i.a.createElement("div",{className:t.inputContainer},i.a.createElement(Ua.a,{placeholder:"regex",style:c,value:"regex"===n.type?n.regex:"",onChange:e=>this.handleRegex(e.target.value)}),m))}}const tn={container:{width:$e.sidebar.width-2*$e.sidebar.filter.margin,boxSizing:"border-box",paddingLeft:$e.sidebar.filter.margin,paddingRight:$e.sidebar.filter.margin,paddingTop:$e.sidebar.filter.margin},plotContainer:{width:$e.sidebar.width-2*$e.sidebar.filter.margin,boxSizing:"border-box",position:"relative",overflow:"hidden",cursor:"default",userSelect:"none",zIndex:1e3},inputContainer:{height:39,width:$e.sidebar.width-2*$e.sidebar.filter.margin,marginBottom:-21,paddingTop:7,zIndex:100,position:"relative"},extraOptionsInput:{float:"right",marginTop:-6,width:28,transform:"scale(0.6)",transformOrigin:"0 0"}};var an=Object(He.a)(tn)(en),nn=a(42),ln=a(279),on=a(147),sn=a(275),rn=a(96),cn=a(99);const dn={};class pn extends i.a.Component{componentDidMount(){const e=this.props,t=e.condDist,a=e.width,n=e.height,i=t.delta,l=[t.breaks[0],t.breaks[t.breaks.length-1]+i],o=Object(ln.a)().domain(l).range([5,a-5]),s=Object(ln.a)().domain([0,t.max]).range([n-16,0]),r=Object(on.a)(s).scale(o).ticks(5).tickSize(4),c=n-16,d=o(i)-o(0);this.d3pars={axisPad:16,sidePad:5,delta:i,xrange:l,xs:o,ys:s,axis:r,height:c,barWidth:d,barPath:(e,t)=>{const a=[];let n=0;const i=e.length;let l,o;for(;n<i;)l=e[n],o=0===l.value?t.ys(l.value):t.ys(l.value)-1,a.push("M",t.xs(l.key)+1,",",t.height,"V",o,"h",t.barWidth-1,"V",t.height),n+=1;return a.join("")}},this._d3node.call(dn.enter.bind(this,this.props,this.d3pars))}componentDidUpdate(){const e=this.props.condDist;this.d3pars.ys.domain([0,e.max]),this._d3node.call(dn.update.bind(this,this.props,this.d3pars))}render(){const e=this.props,t=e.width,a=e.height;return i.a.createElement("svg",{ref:e=>{this._d3node=Object(sn.a)(e)},width:t,height:a})}}var hn=pn;dn.enter=(e,t,a)=>{const n=Object(cn.a)().extent([[t.sidePad,1],[e.width-t.sidePad,t.height+1]]).handleSize(10);n.on("brush",()=>{const e=rn.c.selection;a.select("#cliprect").attr("x",e[0]).attr("width",e[1]-e[0])}).on("end",()=>{if(rn.c.sourceEvent)if(rn.c.selection){const a=rn.c.selection.map(e=>(e=>{const t=Math.max(Math.floor(Math.log10(Math.abs(e))),5);return parseFloat(e.toPrecision(t))})(t.xs.invert(e)));e.handleChange(a)}else a.select("#cliprect").attr("x",t.xs(t.xrange[0])).attr("width",t.xs(t.xrange[1])-t.xs(t.xrange[0])),e.handleChange(void 0)});const i=a.append("g"),l=Object.assign([],t.xrange);e.filterState.value&&(e.filterState.value.from&&(l[0]=e.filterState.value.from),e.filterState.value.to&&(l[1]=e.filterState.value.to)),i.append("clipPath").attr("id","clip-".concat(e.name)).append("rect").attr("id","cliprect").attr("x",t.xs(l[0])).attr("width",t.xs(l[1])-t.xs(l[0])).attr("height",e.height-t.axisPad),i.append("path").attr("class","bar background").datum(e.condDist.dist).attr("fill","#ddd"),i.append("path").attr("class","bar foreground").datum(e.condDist.dist).attr("clip-path","url(#clip-".concat(e.name,")")),e.filterState.value?i.selectAll(".foreground").attr("fill","rgb(255, 170, 10)"):i.selectAll(".foreground").attr("fill","rgb(255, 210, 127)");const o=a.append("g").attr("class","axis").attr("transform","translate(0,".concat(e.height-t.axisPad+1,")")).call(t.axis);o.select("path").attr("fill","none").attr("stroke","#000").attr("stroke-opacity",.4).attr("shape-rendering","crispEdges"),o.selectAll(".tick").attr("opacity",.4);const s=i.append("g").attr("class","brush").call(n);e.filterState.value&&s.call(n.move,[t.xs(l[0]),t.xs(l[1])]),s.select("rect.selection").attr("fill","rgb(255, 210, 127)").attr("fill-opacity","0.125").attr("stroke","rgb(255, 170, 10)").attr("stroke-opacity","0.2"),s.selectAll("rect").attr("height",t.height),a.selectAll(".bar").attr("d",e=>t.barPath(e,t))},dn.update=(e,t,a)=>{if(a.selectAll(".bar").attr("d",null).datum(e.condDist.dist).attr("d",e=>t.barPath(e,t)),void 0!==e.filterState.value){let n=e.filterState.value.from,i=e.filterState.value.to;void 0===n&&(n=t.xrange[0]),void 0===i&&(i=t.xrange[1]),i>n&&(a.select(".brush").call(Object(cn.a)().move,[t.xs(n),t.xs(i)]),a.select("#cliprect").attr("x",t.xs(n)).attr("width",t.xs(i)-t.xs(n)),a.selectAll("path.foreground").attr("fill","rgb(255, 170, 10)"))}else a.select(".brush").call(Object(cn.a)().move,null),a.selectAll("path.foreground").attr("fill","rgb(255, 210, 127)"),a.select("#cliprect").attr("x",t.xs(t.xrange[0])).attr("width",t.xs(t.xrange[1])-t.xs(t.xrange[0]))};class mn extends i.a.Component{constructor(e){super(e),this.stateValue={},this.handleBrushInput=this.handleBrushInput.bind(this)}componentDidUpdate(){void 0===this.props.filterState.value&&this._fromInput&&this._toInput&&(this._fromInput.input.value=null,this._toInput.input.value=null)}setValidState(e,t,a){const n=this.props,i=n.filterState,l=n.handleChange,o=this.checkValidNumber(e,t,a);void 0!==i.valid&&i.valid===o||l(Object.assign(i,{valid:o}))}handleInput(e,t){const a=this.props,n=a.filterState,i=a.handleChange;let l={};const o=""===e?void 0:parseFloat(e),s="from"===t?o:this.stateValue.from,r="to"===t?o:this.stateValue.to;l=void 0===s&&void 0===r?{name:n.name,type:"range",varType:n.varType,valid:!0}:{name:n.name,type:"range",varType:n.varType,value:{from:s,to:r},valid:this.checkValidNumber(s,r,t)},i(l)}handleBrushInput(e){const t=this.props,a=t.filterState,n=t.handleChange;if(void 0===e){n({name:a.name,type:"range",varType:a.varType,valid:!0}),this._fromInput&&this._toInput&&(this._fromInput.input.value=null,this._toInput.input.value=null)}else{if(n({name:a.name,type:"range",varType:a.varType,value:{from:e[0],to:e[1]},valid:!0}),this._fromInput&&this._toInput){var i=Object(nn.a)(e,2);this._fromInput.input.value=i[0],this._toInput.input.value=i[1]}}}checkValidNumber(e,t,a){if("to"===a){if(e&&parseFloat(e)>parseFloat(t))return!1}else if(t&&parseFloat(t)<parseFloat(e))return!1;return!0}render(){const e=this.props,t=e.classes,a=e.filterState,n=e.dist,l=e.condDist,o=e.name,s={textAlign:"center"};void 0===a.valid||a.valid||(s.color="red");const r={width:75,marginTop:-5,fontSize:16,transform:"scale(0.85)",transformOrigin:"0 0"},c={textAlign:"center",paddingBottom:2};this.stateValue=a.value,void 0===this.stateValue&&(this.stateValue={});const d=this.stateValue,p=d.to,h=d.from;p&&h&&p<h&&(c.color="red");const m=n.dist.raw.breaks,g=(m[1]-m[0])*m.length,u=Math.pow(10,Math.round(Math.log10(g/100)-.4));return i.a.createElement("div",{className:t.container},i.a.createElement("div",{className:t.plotContainer},i.a.createElement(hn,{name:o,className:t.plotContainer,width:$e.sidebar.width-2*$e.sidebar.filter.margin,height:$e.sidebar.filter.num.height,dist:n,condDist:l,filterState:a,handleChange:this.handleBrushInput})),i.a.createElement("div",{className:t.inputContainer},i.a.createElement("div",{className:t.rangeInputText},"Range:"),i.a.createElement(Ua.a,{name:"fromText",style:r,inputProps:{style:c},type:"number",step:u,value:this.stateValue.from?this.stateValue.from:"",onChange:e=>this.handleInput(e.target.value,"from")}),i.a.createElement("div",{className:"".concat(t.rangeInputText," ").concat(t.rangeInputTextDash)},"-"),i.a.createElement(Ua.a,{name:"toText",style:r,inputProps:{style:c},type:"number",step:u,value:this.stateValue.to?this.stateValue.to:"",onChange:e=>this.handleInput(e.target.value,"to")})))}}const gn={container:{marginLeft:5,marginRight:5,marginTop:5},plotContainer:{width:$e.sidebar.width-2*$e.sidebar.filter.margin,height:$e.sidebar.filter.num.height,position:"relative",overflow:"hidden",cursor:"default",userSelect:"none",zIndex:1e3},inputContainer:{width:$e.sidebar.width-2*$e.sidebar.filter.margin,marginBottom:-12,paddingBottom:8,paddingTop:4,zIndex:100,position:"relative",verticalAlign:"center"},rangeInputText:{fontSize:13,paddingRight:10,display:"inline-block"},rangeInputTextDash:{paddingLeft:4,transform:"scale(2,1)"}};var un=Object(He.a)(gn)(mn);const bn={col1:{position:"absolute",top:$e.sidebar.header.height,left:0},col2:{position:"absolute",top:$e.sidebar.header.height,left:$e.sidebar.width,borderLeft:"1px solid ".concat($e.sidebar.borderColor)},notUsedHeader:{height:30,lineHeight:"30px",paddingLeft:10,boxSizing:"border-box",width:$e.sidebar.width,fontSize:14},notUsedContainer:{width:$e.sidebar.width,overflowY:"auto",boxSizing:"border-box",paddingLeft:10,paddingRight:10,paddingBottom:10},variable:{display:"inline-block",boxShadow:"rgba(0, 0, 0, 0.117647) 0px 1px 6px, rgba(0, 0, 0, 0.117647) 0px 1px 4px",borderRadius:10,paddingTop:"2px !important",paddingBottom:"3px !important",paddingLeft:"7px !important",paddingRight:"7px !important",border:0,background:"white",margin:"3px !important",fontSize:12,cursor:"pointer",color:"black",transition:"all 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms","&:hover":{transition:"all 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms",background:"#ebebeb"}},variableActive:{background:"#81C784",color:"white","&:hover":{background:Object(Ht.emphasize)("#81C784",.2)}},allContainer:{width:$e.sidebar.width,boxSizing:"border-box"},container:{width:$e.sidebar.width,boxSizing:"border-box",zIndex:100,position:"relative",paddingBottom:6,borderBottom:"1px solid ".concat($e.sidebar.borderColor)},header:{height:16,lineHeight:"15px",width:$e.sidebar.width,marginTop:1,fontSize:12,position:"relative"},headerExtra:{position:"absolute",right:38,height:16,lineHeight:"15px",fontSize:11,color:"#777"},headerName:{height:16,paddingLeft:5,paddingRight:5,position:"absolute",left:1,userSelect:"none",cursor:"default",background:"#999"},headerNameActive:{background:"#81C784"},headerNameText:{color:"white"},headerIcon:{height:16,color:"#666",cursor:"pointer",position:"absolute",border:"none",background:"none",marginTop:-1,padding:0,zIndex:1e3,"&:hover":{transition:"all 150ms cubic-bezier(0.23, 1, 0.32, 1) 0ms",color:"#aaa"}},headerIconHide:{visibility:"hidden"},headerClose:{right:5},headerReset:{right:18}},fn=Object(Z.a)(oe,se,Et,Ct,te,fe,It,de,(e,t,a,n,i,l,o,s)=>({styles:{col1:{height:n},col2:{height:n,display:null===o.cutoff?"none":"inline"},notUsedContainer:{height:n-35-o.heights[null===o.cutoff?0:1]},allContainer:{height:n}},catHeight:$e.sidebar.filter.cat.height,filter:e,filterView:t,cogInfo:a,curDisplayInfo:i,filtDist:l,colSplit:o,labels:s}));var vn=Object(s.b)(e=>fn(e),e=>({handleViewChange:(t,a,n)=>{if("add"===a&&n.indexOf(t)<0){const a=Object.assign([],n);a.push(t),e(P(a))}e(F(t,a))},handleFilterChange:t=>{let a;"string"===typeof t||t instanceof String?a=t:(a={},a[t.name]=Object(Ce.a)({},t)),e(W(a)),e(z({pageNum:1}))},handleFilterSortChange:t=>{const a={};a[t.name]=t,e(W(a))}}))(Object(He.a)(bn)(({classes:e,styles:t,catHeight:a,filter:n,filterView:l,cogInfo:o,curDisplayInfo:s,filtDist:r,colSplit:c,handleViewChange:d,handleFilterChange:p,handleFilterSortChange:h,labels:m})=>{let g=i.a.createElement("div",null);const u=s.info.name;if(n&&l.active&&c){let b=[],f=[];null===c.cutoff?b=l.active:(b=l.active.slice(0,c.cutoff),f=l.active.slice(c.cutoff,l.active.length));const v=[b,f].map(t=>t.map((t,l)=>{if(r[t]){let l=n[t],c="";const m=l&&void 0!==l.value;let g=i.a.createElement("div",{key:"".concat(t,"_").concat(u)},t);if("factor"===o[t].type||"time"===o[t].type||"date"===o[t].type){l||(l={name:t,orderValue:"ct,desc",type:"select",varType:"factor"});const e=o[t].levels?o[t].levels.length:1e3;g=i.a.createElement(an,{filterState:l,height:Math.min(a,15*e),dist:s.info.cogDistns[t],condDist:r[t],levels:s.info.cogInfo[t].levels,handleChange:p,handleSortChange:h}),c="".concat(r[t].totSelected," of ").concat(r[t].dist.length)}else"numeric"===o[t].type&&(l||(l={name:t,orderValue:"ct,desc",type:"range",varType:"numeric"}),g=i.a.createElement(un,{name:t,filterState:l,dist:s.info.cogDistns[t],condDist:r[t],handleChange:p}));return i.a.createElement("div",{key:"".concat(t,"_").concat(u),className:e.container},i.a.createElement("div",{className:e.header},i.a.createElement("div",{className:Ft()({[e.headerName]:!0,[e.headerNameActive]:m})},i.a.createElement("span",{"data-tip":!0,"data-for":"hdtooltip_".concat(t)},i.a.createElement("span",{className:e.headerNameText},t))),i.a.createElement(La.a,{place:"right",id:"hdtooltip_".concat(t)},i.a.createElement("span",null,o[t].desc)),i.a.createElement("div",{className:e.headerExtra},c),i.a.createElement("button",{type:"button",key:"".concat(t,"_").concat(u,"-close-icon"),className:"".concat(e.headerIcon," ").concat(e.headerClose),onMouseDown:()=>d(t,"remove")},i.a.createElement("i",{className:"icon-times-circle"})),i.a.createElement("button",{type:"button",key:"".concat(t,"_").concat(u,"-reset-icon"),className:Ft()({[e.headerIcon]:!0,[e.headerReset]:!0,[e.headerIconHide]:!m}),onMouseDown:()=>p(l.name)},i.a.createElement("i",{className:"icon-undo"}))),g)}return""})),y=null===c.cutoff?0:1,w=Object.keys(o),E=Fa()(w,l.inactive);t.notUsedContainer.height<170&&1===y?v[y].push(i.a.createElement("div",{key:"notUsedHeader",className:e.notUsedHeader},"Remove filters to select more.")):(v[y].push(i.a.createElement("div",{key:"notUsedHeader",className:e.notUsedHeader},0===l.active.length?"Select a variable to filter on:":0===l.inactive.length?"":"More variables:")),v[y].push(i.a.createElement("div",{key:"notUsed",className:e.notUsedContainer,style:t.notUsedContainer},E.map(t=>i.a.createElement("span",{key:"".concat(t,"_").concat(u)},i.a.createElement("span",{"data-tip":!0,"data-for":"tooltip_".concat(t)},i.a.createElement("button",{type:"button",className:Ft()({[e.variable]:!0,[e.variableActive]:n[t]&&void 0!==n[t].value}),key:"".concat(t,"_").concat(u,"_button_").concat(E.length),onClick:()=>d(t,"add",m)},t)),i.a.createElement(La.a,{place:"right",id:"tooltip_".concat(t)},i.a.createElement("span",null,o[t].desc))))))),g=i.a.createElement("div",{className:e.allContainer,style:t.allContainer},i.a.createElement("div",{className:e.col1,style:t.col1},v[0]),i.a.createElement("div",{className:e.col2,style:t.col2},v[1]))}return g}));const yn=Object(Z.a)(Nt,te,Et,(e,t,a)=>({width:$e.sidebar.width,height:e-$e.sidebar.header.height,views:t.info.views,cinfo:a}));var wn=Object(s.b)(e=>yn(e),e=>({handleChange:(t,a)=>{const n={};if(t.replace("#","").split("&").forEach(e=>{const t=e.split("=");n[t[0]]=t[[1]]}),n.nrow&&n.ncol&&n.arr){const t={nrow:parseInt(n.nrow,10),ncol:parseInt(n.ncol,10),arrange:n.arr};e(z(t))}if(n.pg&&e(z({pageNum:parseInt(n.pg,10)})),n.labels){const t=n.labels.split(",");e(P(t))}let i=[];n.sort&&(i=n.sort.split(",").map((e,t)=>{const a=e.split(";");return{order:t+1,name:a[0],dir:a[1]}})),e(B(i));const l={};if(n.filter){n.filter.split(",").forEach(e=>{const t={};e.split(";").forEach(e=>{const a=e.split(":");t[a[0]]=a[[1]]});const n={name:t.var,type:t.type,varType:a[t.var].type};if("select"===t.type)n.orderValue="ct,desc",n.value=t.val.split("#").map(decodeURIComponent);else if("regex"===t.type){const e=a[t.var].levels,i=[],l=new RegExp(decodeURIComponent(t.val),"i");e.forEach(e=>{null!==e.match(l)&&i.push(e)}),n.regex=t.val,n.value=i,n.orderValue="ct,desc"}else if("range"===t.type){const e=t.from?parseFloat(t.from,10):void 0,a=t.to?parseFloat(t.to,10):void 0;n.value={from:e,to:a},n.valid=!0,e&&a&&e>a&&(n.valid=!1)}l[t.var]=n})}e(W({})),e(W(l)),n.fv&&n.fv.split(",").map(t=>e(F(t,"add")))}}))(Object(He.a)({rowDesc:{color:"#888",fontStyle:"italic"}})(({height:e,views:t,cinfo:a,handleChange:n})=>i.a.createElement("div",{style:{height:e,overflowY:"auto"}},i.a.createElement(va.a,{style:{padding:0}},t.map(e=>i.a.createElement(ya.a,{key:e.name,dense:!0,button:!0,onClick:()=>n(e.state,a)},i.a.createElement(wa.a,{primary:e.name})))))));const En={sidebarContainer:{transitionProperty:"left",transitionDuration:$e.trans.duration,transitionTimingFunction:$e.trans.timing,position:"absolute",left:$e.sideButtons.width,top:$e.header.height,height:"100%",boxSizing:"border-box",borderRight:"1px solid",borderColor:"".concat($e.sidebar.borderColor," !important"),background:"#fff",zIndex:999,overflow:"hidden"},hidden:{transitionProperty:"left",transitionDuration:$e.trans.duration,transitionTimingFunction:$e.trans.timing,left:$e.sideButtons.width-$e.sidebar.width},header:{paddingLeft:10,boxSizing:"border-box",fontSize:$e.sidebar.header.fontSize,background:$e.sidebar.header.background,height:$e.sidebar.header.height,lineHeight:"".concat($e.sidebar.header.height,"px"),color:$e.sidebar.header.color,borderLeft:"1px solid #ccc"},empty:{paddingLeft:8,paddingTop:5}},xn=Object(Z.a)(Nt,Ot,e=>!(!e.selectedDisplay||""===e.selectedDisplay.name||!e._displayInfo[e.selectedDisplay.name])&&e._displayInfo[e.selectedDisplay.name].isLoaded,It,(e,t,a,n)=>({styles:{sidebarContainer:{width:$e.sidebar.width*(1+("Filter Panels"===t&&n&&null!==n.cutoff)),height:e}},active:t,displayLoaded:a}));var Sn=Object(s.b)(e=>xn(e))(Object(He.a)(En)(({classes:e,styles:t,active:a,displayLoaded:n})=>{if(""===a)return i.a.createElement("div",{className:"".concat(e.sidebarContainer," ").concat(e.hidden),style:t.sidebarContainer});let l;if("Configuration"===a)l=i.a.createElement("div",{className:e.empty},"Configuration...");else if(n)switch(a){case"Panel Grid Layout":l=i.a.createElement("div",null,i.a.createElement(Ta,null));break;case"Filter Panels":l=i.a.createElement("div",null,i.a.createElement(vn,null));break;case"Sort Panels":l=i.a.createElement("div",null,i.a.createElement(Ba,null));break;case"Show/Hide Labels":l=i.a.createElement("div",null,i.a.createElement(xa,null));break;case"Views":l=i.a.createElement("div",null,i.a.createElement(wn,null));break;default:l=""}else l=i.a.createElement("div",{className:e.empty},"Load a display...");return i.a.createElement("div",{className:e.sidebarContainer,style:t.sidebarContainer},i.a.createElement("div",{className:e.header},a),l)})),_n=a(139),On=a(289),Cn=a(140),In=a.n(Cn),kn=a(273),Nn=a(141),Dn=a.n(Nn);class jn extends i.a.Component{constructor(e){super(e),this.myRef=i.a.createRef(),this.isSelfContained=void 0!==e.panelData&&"__self__"===e.cfg.display_base;let t=[e.curDisplayInfo.info.name];e.relDispPositions.length>0&&(t=e.relDispPositions.map(e=>e.name));const a={panels:{},hover:"",textInputOpen:"",inputChangeCounter:0};t.forEach(t=>{"image_src"===e.displayInfo[t].info.panelInterface.type?a.panels[t]={panelContent:e.panelRenderers[t].fn(e.displayInfo[t].info.imgSrcLookup[e.panelKey],e.dims.ww,e.dims.hh,!1,e.panelKey),panelData:e.panelData,loaded:!0}:this.isSelfContained?a.panels[t]={panelContent:e.panelRenderers[t].fn(e.panelData,e.dims.ww,e.dims.hh,!1,e.panelKey),panelData:e.panelData,loaded:!0}:a.panels[t]={loaded:!1,panelContent:null,panelData:null}}),this.state=a}componentDidMount(){const e=this.state.panels,t=this.props,a=t.cfg,n=t.panelKey,i=t.panelRenderers,l=t.dims,o=t.curDisplayInfo,s=t.displayInfo,r=t.relDispPositions;let c=[o.info.name];r.length>0&&(c=r.map(e=>e.name)),c.forEach((t,o)=>{const c=i[t],d=s[t].info.cogInterface;let p=l.ww,h=l.hh;if(r.length>0&&(h=l.hh*r[o].height,p=h/r[o].aspect),e[t].loaded)c.fn(e[t].panelData,p,h,!0,"".concat(n,"_").concat(t));else{let e="".concat(a.cog_server.info.base).concat(d.group);e="".concat(e,"/").concat(d.name),window.__panel__||(window.__panel__={}),window.__panel__["_".concat(n,"_").concat(t)]=e=>{const a=this.state.panels;this.setState({panels:Object(Ce.a)(Object(Ce.a)({},a),{},{[t]:{panelContent:c.fn(e,p,h,!1,"".concat(n,"_").concat(t)),panelData:e,loaded:!0}})})},"jsonp"===a.cog_server.type?this.xhr=C()({url:"".concat(e,"/jsonp/").concat(n,".jsonp"),callbackName:"__panel_".concat(n,"_").concat(t)}):this.xhr=(m={url:"".concat(e,"/json/").concat(n,".json"),callback:window.__panel__["_".concat(n,"_").concat(t)]},Object(S.a)(m.url,e=>m.callback(e)))}var m});const d=this._panel;d.style.opacity=0,setTimeout(()=>d.style.opacity=1,10)}UNSAFE_componentWillReceiveProps(e){const t=this.state.panels,a=Object.keys(t).every(e=>t[e].loaded),n=this.props.dims,i=e.dims.ww!==n.ww,l=e.curDisplayInfo.info.name;if(a&&i)if("image"===e.panelInterface.type){const a=e.panelRenderers[l],n=Object(Ce.a)({},t);0===e.relDispPositions.length&&(n[l].panelContent=a.fn(t[l].panelData,e.dims.ww,e.dims.hh,!1,"".concat(e.panelKey,"_").concat(l))),this.setState({panels:n})}else if("htmlwidget"===e.panelInterface.type){const t=I(e.panelInterface.deps.name);if(t){const a=document.getElementById("widget_".concat(e.panelKey));a&&(a.style.width="".concat(e.dims.ww,"px"),a.style.height="".concat(e.dims.hh,"px"),t.resize(a,e.dims.ww,e.dims.hh))}}}componentDidUpdate(){const e=this.state.panels,t=this.props,a=t.panelKey,n=t.panelRenderers,i=t.dims,l=t.curDisplayInfo,o=t.relDispPositions;let s=[l.info.name];o.length>0&&(s=o.map(e=>e.name)),s.forEach((t,l)=>{if(e[t].loaded){let s=i.ww,r=i.hh;o.length>0&&(r=i.hh*o[l].height,s=r/o[l].aspect);n[t].fn(e[t].panelData,s,r,!0,"".concat(a,"_").concat(t))}})}componentWillUnmount(){const e=this.props,t=e.panelKey,a=e.curDisplayInfo.info.name;this.xhr&&this.xhr.abort(),!this.isSelfContained&&window.__panel__&&window.__panel__["_".concat(t,"_").concat(a)]&&(window.__panel__["_".concat(t,"_").concat(a)]=null)}setTextInputOpen(e){this.setState({textInputOpen:e})}handleHover(e){this.setState({hover:e})}render(){const e=this.props,t=e.classes,a=e.dims,n=e.rowIndex,l=e.iColIndex,o=e.labels,s=e.labelArr,r=e.removeLabel,c=e.curDisplayInfo,d=e.relDispPositions,p=e.panelKey,h=this.state,m=h.panels,g=h.hover,u=h.inputChangeCounter,b=h.textInputOpen,f=c.info.name,v=Object.keys(m).every(e=>m[e].loaded);let y=m[f].panelContent;v&&d.length>0&&(y=i.a.createElement("div",null,d.map(e=>i.a.createElement("div",{key:e.name,style:{position:"absolute",top:e.top*a.hh,left:e.left*a.hh,height:e.height*a.hh,width:e.width*a.hh}},m[e.name].panelContent))));const w=d.length>0?a.contentWidth-6:a.ww,E=d.length>0?1:a.pWidth*l+(l+1)*a.pPad+a.wOffset+2*l+1,x={bounding:{width:w+2,height:a.hh+a.nLabels*a.labelHeight+2,top:a.pHeight*n+(n+1)*a.pPad+2*n,right:E},panel:{width:w,height:a.hh},panelContent:{width:w,height:a.hh},labelTable:{width:w},labelRow:{width:w,height:a.labelHeight,lineHeight:"".concat(a.labelHeight,"px")},labelSpan:{fontSize:a.fontSize,position:"absolute"},labelClose:{fontSize:a.fontSize,lineHeight:"".concat(a.labelHeight,"px")},labelInner:{height:a.labelHeight},labelNameCell:{paddingLeft:a.labelPad/2+2,paddingRIght:a.labelPad/2+2,width:a.labelWidth},labelValueCell:{paddingLeft:a.labelPad/2+2,paddingRIght:a.labelPad/2+2},linkIcon:{textDecoration:"none",fontSize:a.fontSize-2},radioDiv:{transform:"scale(".concat(a.labelHeight/29,")"),transformOrigin:"left top",marginTop:-4}};return i.a.createElement("div",{className:t.bounding,style:x.bounding,ref:e=>{this._panel=e}},i.a.createElement("div",{className:t.panel,style:x.panel},v?y:i.a.createElement(In.a,{wait:500},i.a.createElement("div",null,"'loading...'"))),i.a.createElement("div",{ref:this.myRef},i.a.createElement("table",{className:t.labelTable,style:x.labelTable},i.a.createElement("tbody",null,o.map((e,n)=>{let l;const o=i.a.createElement("button",{type:"button",className:t.labelClose,style:Object(Ce.a)(Object(Ce.a)({},x.labelClose),g!==e.name&&{display:"none"}),onClick:()=>r(e.name,s)},i.a.createElement("i",{className:"icon-times-circle"}));if("href"===e.type)l=i.a.createElement("div",{className:t.labelInner,style:x.labelInner},i.a.createElement("a",{style:Object(Ce.a)(Object(Ce.a)({},x.labelSpan),{},{textDecoration:"none"}),href:e.value,rel:"noopener noreferrer",target:"_blank"},i.a.createElement("i",{className:"icon-open",style:x.linkIcon})));else if("href_hash"===e.type)l=i.a.createElement("div",{className:t.labelInner,style:x.labelInner},i.a.createElement("a",{style:Object(Ce.a)(Object(Ce.a)({},x.labelSpan),{},{textDecoration:"none"}),href:"#open_in_same_window",onClick:()=>{window.location.href=e.value,window.location.reload()}},i.a.createElement("i",{className:"icon-open",style:x.linkIcon})));else if("input_radio"===e.type){const a="".concat(c.info.group,"_:_").concat(c.info.name,"_:_").concat(p,"_:_").concat(e.name),n=c.info.cogInfo[e.name].options;l=i.a.createElement("div",{className:t.labelInner,style:x.labelInner,title:e.value},i.a.createElement("div",{style:x.radioDiv},i.a.createElement(_a.a,{"aria-label":e.name,name:e.name,classes:{root:t.formRow},value:localStorage.getItem(a)||"",onClick:e=>{e.target.value&&(localStorage.getItem(a)===e.target.value?localStorage.removeItem(a):localStorage.setItem(a,e.target.value),document.activeElement.blur(),this.setState({inputChangeCounter:u+1}))},row:!0},n.map(e=>i.a.createElement(Oa.a,{key:e,value:e,control:i.a.createElement(Sa.a,{disableRipple:!0,size:"small"}),label:e})))))}else if("input_text"===e.type){const n="".concat(c.info.group,"_:_").concat(c.info.name,"_:_").concat(p,"_:_").concat(e.name),o=i.a.createRef(),s=i.a.createElement("button",{type:"button",className:t.editButton,style:Object(Ce.a)({},x.labelClose),onClick:()=>this.setTextInputOpen(e.name)},i.a.createElement(Dn.a,{style:{fontSize:a.fontSize}}));l=i.a.createElement("div",{className:t.labelInner,style:Object(Ce.a)(Object(Ce.a)({},x.labelInner),{display:"flex",paddingRight:a.fontSize+4}),title:e.value,ref:o},i.a.createElement("div",{className:t.labelP,style:{fontSize:a.fontSize},onClick:()=>this.setTextInputOpen(e.name),role:"button",onKeyDown:()=>{},tabIndex:"-1"},localStorage.getItem(n)||""),i.a.createElement("div",null,s),i.a.createElement(kn.a,{open:b===e.name,anchorEl:this.myRef.current,onClose:()=>this.setTextInputOpen(""),anchorOrigin:{vertical:"top",horizontal:"center"},transformOrigin:{vertical:"top",horizontal:"center"}},i.a.createElement("div",{style:{padding:7}},i.a.createElement(Ua.a,{id:"outlined-multiline-static",label:"".concat(e.name," ('esc' when complete)"),onChange:e=>{""===e.target.value&&localStorage.getItem(n)?localStorage.removeItem(n):localStorage.setItem(n,e.target.value),this.setState({inputChangeCounter:u+1})},value:localStorage.getItem(n),style:{minWidth:300},size:"small",autoFocus:!0,multiline:!0,rows:c.info.cogInfo[e.name].height,variant:"outlined"}))))}else l=i.a.createElement("div",{className:t.labelInner,style:x.labelInner,title:e.value},i.a.createElement("span",{className:t.labelP,style:x.labelSpan},e.value));return i.a.createElement("tr",{key:"".concat(e.name),className:Ft()({[t.labelRow]:!0,[t.labelRowHover]:g===e.name}),style:x.labelRow,onMouseOver:()=>this.handleHover(e.name),onFocus:()=>this.handleHover(e.name),onMouseOut:()=>this.handleHover(""),onBlur:()=>this.handleHover("")},i.a.createElement("td",{className:"".concat(t.labelCell," ").concat(t.labelNameCell),style:x.labelNameCell},i.a.createElement("div",{className:t.labelInner,style:x.labelInner,"data-tip":!0,"data-for":"tooltip_".concat(p,"_").concat(e.name)},i.a.createElement("span",{style:x.labelSpan},e.name)),e.name!==e.desc&&i.a.createElement(La.a,{place:"right",id:"tooltip_".concat(p,"_").concat(e.name)},i.a.createElement("span",null,e.desc))),i.a.createElement("td",{className:t.labelCell,style:x.labelValueCell},i.a.createElement("div",{className:t.labelOuter},l,o)))})))))}}jn.defaultProps=()=>({panelInterface:void 0,panelData:void 0});const Tn={bounding:{transitionProperty:"all",transitionDuration:$e.trans.duration,transitionTimingFunction:$e.trans.timing,position:"absolute",overflow:"hidden",padding:0,boxSizing:"border-box",border:"1px solid #ddd"},panel:{transitionProperty:"all",transitionDuration:$e.trans.duration,transitionTimingFunction:$e.trans.timing,boxSizing:"border-box",textAlign:"center",overflow:"hidden",color:"#bbb"},panelContent:{transitionProperty:"all",transitionDuration:$e.trans.duration,transitionTimingFunction:$e.trans.timing,display:"block"},labelTable:{transitionProperty:"all",transitionDuration:$e.trans.duration,transitionTimingFunction:$e.trans.timing,padding:0,tableLayout:"fixed",borderSpacing:0,boxSizing:"border-box"},labelRow:{transitionProperty:"all",transitionDuration:$e.trans.duration,transitionTimingFunction:$e.trans.timing,background:"#f6f6f6"},labelRowHover:{background:Object(Ht.fade)("#f6f6f6",.4)},labelCell:{paddingTop:0,paddingBottom:0},labelNameCell:{borderRight:"1px solid #fff",fontWeight:400},labelOuter:{position:"relative",overflow:"hidden"},labelInner:{paddingRight:3,overflow:"hidden",whiteSpace:"normal",verticalAlign:"middle",position:"relative",cursor:"default"},labelP:{overflow:"hidden",whiteSpace:"nowrap",textOverflow:"ellipsis",width:"100%",margin:0},labelClose:{transition:"1s",position:"absolute",top:0,right:2,cursor:"pointer",border:"none",background:"none",padding:0,margin:0,opacity:.5},editButton:{cursor:"pointer",border:"none",background:"none",padding:0,margin:0,opacity:.5},formRow:{flexWrap:"unset"}};var Ln=Object(He.a)(Tn)(jn);const Rn=({classes:e,contentStyle:t,ccd:a,ci:n,cinfo:l,cfg:o,layout:s,labels:r,dims:c,panelRenderers:d,panelInterface:p,sidebar:h,curPage:m,totPages:g,panelData:u,removeLabel:b,setPageNum:f,curDisplayInfo:v,displayInfo:y,relDispPositions:w})=>{let E=i.a.createElement("div",null),x=[v.info.name];w.length>0&&(x=w.map(e=>e.name));const S=x.every(e=>d[e]&&null!==d[e].fn),_=x.every(e=>y[e]&&y[e].isLoaded);if(n&&a&&l&&S&&_&&p){const n=[],x=[];for(let e=0;e<a.length;e+=1){n.push(a[e].panelKey);const t=[];for(let n=0;n<r.length;n+=1)t.push({name:r[n],value:a[e][r[n]],type:l[r[n]].type,desc:l[r[n]].desc});x.push(t)}const S=[];for(let e=0;e<a.length;e+=1){let t,a;"row"===s.arrange?(t=Math.floor(e/s.ncol),a=e%s.ncol):(t=e%s.nrow,a=Math.floor(e/s.nrow)),S.push({rowIndex:t,colIndex:a,iColIndex:s.ncol-a-1,key:n[e],labels:x[e]})}S.sort((e,t)=>e.key>t.key?1:t.key>e.key?-1:0);let _="";if("htmlwidget"===p.type&&(_="_".concat(s.nrow,"_").concat(s.ncol,"_").concat(h,"_").concat(r.length),_+="_".concat(t.width,"_").concat(t.height)),w.length>0){const e=w.map(e=>e.name).join("_");let a="";a=w.map(e=>e.left+e.top+e.width+e.height).reduce((e,t)=>e+t),_="".concat(_,"_").concat(e,"_").concat(a,"_").concat(r.length),_+="_".concat(t.height)}E=i.a.createElement(_n.a,{onSwipedRight:()=>f("right",m,g),onSwipedLeft:()=>f("left",m,g)},i.a.createElement("div",{className:e.content,style:t},S.map(e=>i.a.createElement(Ln,{key:"".concat(e.key).concat(_),cfg:o,panelKey:e.key,labels:e.labels,labelArr:r,panelRenderers:d,panelData:u[e.key],panelInterface:p,removeLabel:b,dims:c,rowIndex:e.rowIndex,iColIndex:e.iColIndex,curDisplayInfo:v,displayInfo:y,relDispPositions:w}))))}return E};Rn.defaultProps=()=>({ci:void 0,panelInterface:void 0});const An={content:{background:"#fdfdfd",position:"absolute",top:$e.header.height,right:0,boxSizing:"border-box",padding:0}},zn=Object(Z.a)(kt,Nt,ve,e=>e._cogDataMutable.iface,ce,be,de,Et,pe,e=>e.panelRenderers,te,Ot,ie,ye,le,e=>e._localPanels,e=>e.relDispPositions,e=>e._displayInfo,(e,t,a,n,i,l,o,s,r,c,d,p,h,m,g,u,b,f)=>{const v=$e.content.panel.pad;let y=Math.round(e/i.ncol,0),w=Math.round(y*l,0);w*i.nrow>t&&(w=Math.round(t/i.nrow,0),y=Math.round(w/l,0));let E=.08*Math.min(y,w);E=Math.max(Math.min(E,26),13);const x=E/1.625-4,S=E-x,_=o.length,O=(v+2)*(i.ncol+1),C=(v+2)*(i.nrow+1)+_*E*i.nrow;let I=Math.round((e-O)/i.ncol,0),k=Math.round(I*l,0),N=0;k*i.nrow+C>t&&(k=Math.round((t-C)/i.nrow,0),I=Math.round(k/l,0),N=(e-(I*i.ncol+O))/2),b.length>0&&(k=t-C,I=e-O,N=0);const D=u,j=((e,t)=>{const a=document.createElement("span");a.style.fontWeight="normal",a.style.fontSize="".concat(t,"px"),a.style.fontFamily="Open Sans",a.style.visibility="hidden";const n=document.body.appendChild(a),i=e.map(e=>(n.innerHTML=e,n.offsetWidth));return document.body.removeChild(n),Object(On.a)(i)})(o,S)+x;return{contentStyle:{width:e,height:t},ccd:a,ci:n,cinfo:s,cfg:r,layout:i,labels:o,dims:{ww:I,hh:k,labelHeight:E,labelWidth:j,labelPad:x,fontSize:S,nLabels:_,pWidth:I,pHeight:k+_*E,wOffset:N,hOffset:$e.header.height,pPad:v,contentWidth:e},panelRenderers:c,panelInterface:d.info.panelInterface,sidebar:p,curPage:h,totPages:Math.ceil(m/g),panelData:D,curDisplayInfo:d,displayInfo:f,relDispPositions:b}});var Pn=Object(s.b)(e=>zn(e),e=>({removeLabel:(t,a)=>{const n=a.indexOf(t);if(n>-1){const t=Object.assign([],a);t.splice(n,1),e(P(t))}},setPageNum:(t,a,n)=>{let i=a;"right"===t?(i-=1,i<1&&(i+=1)):(i+=1,i>n&&(i-=1)),e(z({pageNum:i}))}}))(Object(He.a)(An)(Rn));const Bn=Object(Z.a)(St,_t,(e,t)=>({width:e,height:t}));var Wn=Object(s.b)(e=>Bn(e))(Object(He.a)({body:{position:"absolute",top:0,left:0,borderRight:"1px solid #ddd",boxSizing:"border-box"}})(({classes:e,width:t,height:a})=>i.a.createElement("div",{className:e.body,style:{width:t,height:a}},i.a.createElement(fa,null),i.a.createElement(Sn,null),i.a.createElement(Pn,null))));const Fn={wrapper:{border:10,boxSizing:"border-box",display:"flex",textDecoration:"none",marginLeft:3,marginTop:4,padding:0,outline:"none",borderRadius:10,whiteSpace:"nowrap",width:"-webkit-fit-content",background:$e.footer.button.background,height:22,transition:"all 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms"},label:{color:$e.footer.button.color,fontSize:12,fontWeight:400,lineHeight:"20px",paddingLeft:12,paddingRight:12,whiteSpace:"nowrap",WebkitUserSelect:"none"},text:{paddingLeft:5,fontSize:11,fontStyle:"italic"},closeIcon:{display:"inline-block",color:"rgba(0, 0, 0, 0.22)",fill:"rgba(0, 0, 0, 0.22)",height:21,width:21,transition:"all 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms",cursor:"pointer",margin:"1px 1px 0px -8px",WebkitUserSelect:"none","&:hover":{color:Object(Ht.fade)("rgba(0, 0, 0, 0.22)",.4),fill:Object(Ht.fade)("rgba(0, 0, 0, 0.22)",.4)}},indIcon:{paddingRight:5}};var Hn=Object(s.b)(()=>({}),e=>({handleStateClose:t=>{"sort"===t.type?(e(B(t.index)),e(z({pageNum:1}))):"filter"===t.type&&(e(F(t.label,"remove")),e(W(t.label)),e(z({pageNum:1})))}}))(Object(He.a)(Fn)(({classes:e,label:t,icon:a,text:n,index:l,type:o,handleStateClose:s})=>{let r="";""!==a&&(r=i.a.createElement("i",{className:"".concat(a," ").concat(e.indIcon)}));let c="";return""!==n&&(c=i.a.createElement("span",{className:e.text},"(".concat(n,")"))),i.a.createElement("div",{type:"button",className:e.wrapper},i.a.createElement("span",{className:e.label},r,t,c),i.a.createElement("svg",{viewBox:"0 0 24 24",className:e.closeIcon,key:"icon",onClick:()=>s({label:t,index:l,type:o})},i.a.createElement("path",{d:"M12 2C6.47 2 2 6.47 2 12s4.47 10 10 10 10-4.47 10-10S17.53 2 12 2zm5 13.59L15.59 17 12 13.41 8.41 17 7 15.59 10.59 12 7 8.41 8.41 7 12 10.59 15.59 7 17 8.41 13.41 12 17 15.59z"})))})),Mn=a(277),Un=a(206),Vn=a(276),Gn=a(143),Kn=a.n(Gn),Yn=a(142),qn=a.n(Yn);const Qn=Object(Vn.a)(e=>({root:{"& .MuiTextField-root":{margin:e.spacing(1),width:"25ch"}},button:{margin:e.spacing(1)}}));function Jn({open:e,handleClose:t,displayInfo:a}){const n=Qn(),l=i.a.useState(localStorage.getItem("__trelliscope_username")||""),o=Object(nn.a)(l,2),r=o[0],c=o[1],d=i.a.useState(localStorage.getItem("__trelliscope_email")||""),p=Object(nn.a)(d,2),h=p[0],m=p[1],g=i.a.useState(localStorage.getItem("__trelliscope_jobtitle")||""),u=Object(nn.a)(g,2),b=u[0],f=u[1],v=i.a.useState(localStorage.getItem("__trelliscope_otherinfo")||""),y=Object(nn.a)(v,2),w=y[0],E=y[1],x=i.a.useState(0),S=Object(nn.a)(x,2),_=S[0],O=S[1],C=i.a.useState(!1),I=Object(nn.a)(C,2),k=I[0],N=I[1],D=Object(s.c)(ne);if(!D.isLoaded||void 0===D.crossfilter)return"";if(!a.has_inputs)return"";const j="".concat(a.group,"_:_").concat(a.name),T=new RegExp("^".concat(j)),L=a.input_csv_vars||[],R={},A=[];Object.keys(localStorage).forEach(e=>{if(T.test(e)){const t=e.split("_:_"),a=t[2];void 0===R[a]&&(R[a]={}),R[a][t[3]]=localStorage.getItem(e),A.indexOf(t[3])<0&&A.push(t[3])}});const z=["panelKey"],P=D.crossfilter.all(),B=P.map(e=>e.panelKey);z.push(...L,...A),z.push("fullname","email","jobtitle","otherinfo","timestamp");const W=Object.keys(R).map((e,t)=>{const a=[];if(L.length>0){const t=B.indexOf(e);a.push(L.map(e=>P[t][e]))}const n=A.map(t=>R[e][t]?'"'.concat(R[e][t].replace(/"/g,'""'),'"'):""),i=[];return 0===t?i.push('"'.concat((localStorage.getItem("__trelliscope_username")||"").replace(/"/g,'""'),'"'),'"'.concat((localStorage.getItem("__trelliscope_email")||"").replace(/"/g,'""'),'"'),'"'.concat((localStorage.getItem("__trelliscope_jobtitle")||"").replace(/"/g,'""'),'"'),'"'.concat((localStorage.getItem("__trelliscope_otherinfo")||"").replace(/"/g,'""'),'"'),(new Date).toISOString()):i.push("","","","",""),[e,...a,n,i]});return i.a.createElement("div",null,i.a.createElement(Ye.a,{open:e,onClose:()=>{O(0),t()},"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description"},i.a.createElement(Ke.a,{id:"alert-dialog-title"},"Export user inputs"),i.a.createElement(qe.a,{dividers:!0},i.a.createElement(nt.a,{activeStep:_,alternativeLabel:!0},["User info","Download csv","Compose email"].map(e=>i.a.createElement(it.a,{key:e},i.a.createElement(Un.a,null,e)))),0===_&&i.a.createElement("div",null,i.a.createElement(Mn.a,null,"Before exporting the inputs you have provided, we would like to gather some information about you. Please provide at least your full name, after which you will be able to click the 'Export' tab in this window to proceed with the export."),i.a.createElement("div",null,i.a.createElement(Ua.a,{style:{marginBottom:15},required:!0,label:"Full Name",fullWidth:!0,value:r,onChange:e=>{c(e.target.value),localStorage.setItem("__trelliscope_username",e.target.value)}}),i.a.createElement(Ua.a,{style:{marginBottom:15},label:"Email Address",fullWidth:!0,value:h,onChange:e=>{m(e.target.value),localStorage.setItem("__trelliscope_email",e.target.value)}}),i.a.createElement(Ua.a,{style:{marginBottom:15},label:"Job Title",fullWidth:!0,value:b,onChange:e=>{f(e.target.value),localStorage.setItem("__trelliscope_jobtitle",e.target.value)}}),i.a.createElement(Ua.a,{style:{marginBottom:15},multiline:!0,rows:3,label:"Additional Contact Information",fullWidth:!0,value:w,onChange:e=>{E(e.target.value),localStorage.setItem("__trelliscope_otherinfo",e.target.value)}}))),1===_&&i.a.createElement("div",null,i.a.createElement(Mn.a,{id:"alert-dialog-description"},i.a.createElement("p",{style:{marginTop:0}},"A csv file of the inputs you provided has been created. By clicking the 'Compose Email' button below, an email will be drafted and opened in your email client to relay this csv file back to us, at ".concat(a.input_email,".")),i.a.createElement("p",null,"To complete the email, use the 'Download csv' button to download the csv and add it as an attachment to the email before sending. As an alternative, you can download the csv file and compose your own email, sending it to us at ".concat(a.input_email,"."))),i.a.createElement("div",{style:{textAlign:"center"}},i.a.createElement(Je.a,{variant:"contained",color:"primary",className:n.button,endIcon:i.a.createElement(qn.a,null),onClick:()=>{const e=[z.join(","),...W.map(e=>e.join(","))].join("\n"),t=new Blob([e],{type:"text/csv"}),n=document.createElement("a");n.download="".concat(a.name,"_").concat((new Date).toISOString().split("T")[0],".csv"),n.href=window.URL.createObjectURL(t),n.click(),N(!0)}},"Download CSV"))),2===_&&i.a.createElement("div",null,i.a.createElement(Mn.a,{id:"alert-dialog-description"},i.a.createElement("p",{style:{marginTop:0}},"By clicking the 'Compose Email' button below, an email will be drafted and opened in your email client to relay this csv file back to us, at ".concat(a.input_email,".")),i.a.createElement("p",null,i.a.createElement("strong",null,"Note: You must manually attach the csv file downloaded in the previous step to this email prior to sending."))),i.a.createElement("div",{style:{textAlign:"center"}},i.a.createElement(Je.a,{variant:"contained",color:"primary",className:n.button,endIcon:i.a.createElement(Kn.a,null),onClick:()=>{const e="From: ".concat(r,"%0D%0A%0D%0AEmail: ").concat(h,"%0D%0A%0D%0AJob Title: ").concat(encodeURIComponent(b),"%0D%0A%0D%0AOther contact info: ").concat(encodeURIComponent(w),"%0D%0A%0D%0ADisplay: ").concat(a.group," -> ").concat(a.name,"%0D%0A%0D%0A(attach downloaded csv file here before sending)"),t=document.createElement("a");t.href="mailto:".concat(a.input_email,"?subject=").concat("Trelliscope input","&body=").concat(e),t.click()}},"Compose Email"))),i.a.createElement("div",{style:{textAlign:"right"}},i.a.createElement(Je.a,{disabled:0===_,onClick:()=>{O(e=>e-1)},className:n.button},"Back"),_<=1&&i.a.createElement(Je.a,{disabled:0===_&&""===r||1===_&&!k,variant:"contained",color:"primary",onClick:()=>{O(e=>e+1)},className:n.button},"Next"))),i.a.createElement(Qe.a,null,i.a.createElement(Je.a,{onClick:()=>{Object.keys(localStorage).forEach(e=>{T.test(e)&&localStorage.removeItem(e)})}},"Clear all inputs"),i.a.createElement(Je.a,{onClick:()=>{O(0),t()},color:"primary",autoFocus:!0},"Close"))))}const $n=({classes:e,style:t,sort:a,filter:n,nFilt:l,nPanels:o,displayInfo:s})=>{const r=i.a.useState(!1),c=Object(nn.a)(r,2),d=c[0],p=c[1];let h="",m="",g="";return a.length>0&&(h=i.a.createElement("div",{className:e.sectionWrapper},i.a.createElement("div",{className:e.sectionText},"Sorting on:"),i.a.createElement("div",{className:e.chipWrapper},a.map((e,t)=>i.a.createElement(Hn,{key:"".concat(e.name,"_sortchip"),label:e.name,icon:e.icon,text:"",index:t,type:"sort"}))))),n.length>0&&(m=i.a.createElement("div",{className:e.sectionWrapper},i.a.createElement("div",{className:e.sectionText},"Filtering on:"),i.a.createElement("div",{className:e.chipWrapper},n.map((e,t)=>i.a.createElement(Hn,{key:"".concat(e.name,"_filterchip"),label:e.name,icon:"",text:e.text,index:t,type:"filter"}))),i.a.createElement("div",{className:e.filterText},"(".concat(l," of ").concat(o," panels)")))),n.length>0&&a.length>0&&(g=i.a.createElement("div",{className:e.spacer})),i.a.createElement("div",{className:e.wrapper,style:t},i.a.createElement("div",{className:e.inner},h,g,m),s.has_inputs&&i.a.createElement("div",{className:e.buttonDiv},i.a.createElement(Je.a,{size:"small",variant:"contained",color:"primary",onClick:()=>{p(!0)}},"Export Inputs")),i.a.createElement(Jn,{open:d,handleClose:()=>{p(!1)},displayInfo:s}))};$n.defaultProps=()=>({nPanels:0});const Xn={wrapper:{position:"absolute",boxSizing:"border-box",left:0,height:$e.footer.height,paddingLeft:10,margin:0,lineHeight:"".concat($e.footer.height,"px"),fontSize:.5*$e.footer.height,fontWeight:300,background:$e.footer.background,color:$e.footer.color,display:"flex",flexDirection:"row",overflowX:"auto",overflowY:"hidden",zIndex:1001},inner:{display:"flex",flexDirection:"row",whiteSpace:"nowrap",paddingRight:10},sectionWrapper:{display:"flex",flexDirection:"row"},chipWrapper:{display:"flex",flexDirection:"row"},sectionText:{marginRight:3},spacer:{width:12},filterText:{marginLeft:5},buttonDiv:{position:"absolute",right:0,bottom:0}},Zn=Object(Z.a)(re,te,(e,t)=>{const a=[];for(let n=0;n<e.length;n+=1){const i=e[n].name,l=t.info.cogInfo[i].type;let o="icon-sort-amount";"factor"===l?o="icon-sort-alpha":"numeric"===l&&(o="icon-sort-numeric"),o="".concat(o,"-").concat(e[n].dir),a.push({name:i,icon:o})}return a}),ei=Object(Z.a)(e=>e.filter,te,(e,t)=>{const a=Object.keys(e.state),n=[];for(let i=0;i<a.length;i+=1){const l=e.state[a[i]];if(void 0!==l.value){let e="";if("numeric"===l.varType)void 0===l.value.from&&void 0!==l.value.to?e="< ".concat(l.value.to):void 0!==l.value.from&&void 0===l.value.to?e="> ".concat(l.value.from):void 0!==l.value.from&&void 0!==l.value.to&&(e="".concat(l.value.from," -- ").concat(l.value.to));else if("factor"===l.varType){const a=15,n=l.value.length;let i=0,o=0;for(;o<n&&i<=a;)i=i+l.value[o].length+2,o+=1;if(o===n)e=l.value.sort().join(", ");else{const a=t.info.cogInfo[l.name].levels.length;e="".concat(l.value.length," of ").concat(a)}}n.push({name:a[i],text:e})}}return n}),ti=Object(Z.a)(St,Zn,ei,ye,te,me,Nt,(e,t,a,n,i,l,o)=>({style:{width:e-(l?0:$e.footer.height),top:o+$e.header.height},sort:t,filter:a,nFilt:n,displayInfo:i.info,nPanels:i.info.n}));var ai=Object(s.b)(e=>ti(e))(Object(He.a)(Xn)($n));class ni extends i.a.Component{constructor(e){super(e),this.yOffset=window.pageYOffset}componentDidMount(){const e=this.props,t=e.singlePageApp,a=e.fullscreen,n=e.sidebar,i=e.dialog,l=e.appId,o=e.toggleFullscreen,s=e.ww,r=e.hh;t||!a||""!==n||i||Ue.a.bindGlobal("esc",()=>o(!1,l,{width:s,height:r},this.yOffset))}UNSAFE_componentWillReceiveProps(e){const t=this.props,a=t.singlePageApp,n=t.ww,i=t.hh;a||(e.fullscreen&&""===e.sidebar&&!e.dialog&&Ue.a.bindGlobal("esc",()=>e.toggleFullscreen(!1,e.appId,{width:n,height:i},this.yOffset)),e.dialog&&Ue.a.unbind("esc"))}componentWillUnmount(){const e=this.props,t=e.singlePageApp,a=e.fullscreen,n=e.sidebar,i=e.dialog;t||!a||""!==n||i||Ue.a.unbind("esc")}render(){const e=this.props,t=e.singlePageApp,a=e.fullscreen,n=e.appId,l=e.ww,o=e.hh,s=e.toggleFullscreen;if(t)return null;const r=this.props.classes,c=a?"icon-minimize":"icon-maximize";return i.a.createElement("button",{type:"button",className:r.button,onClick:()=>{a||(this.yOffset=window.pageYOffset),s(!a,n,{width:l,height:o},this.yOffset)}},i.a.createElement("i",{className:"".concat(c," ").concat(r.icon)}))}}const ii={button:{position:"absolute",right:0,bottom:0,textAlign:"center",background:Object(Ht.emphasize)($e.footer.background,.2),width:$e.footer.height,height:$e.footer.height,cursor:"pointer",border:"none",transition:"all 100ms ease-in","&:hover":{background:Object(Ht.emphasize)($e.footer.background,.3)}},icon:{color:Object(Ht.emphasize)($e.footer.background,.8),fontSize:"".concat($e.footer.height-16,"px")}},li=Object(Z.a)(Ot,ue,ge,he,me,e=>e.ui.origWidth,e=>e.ui.origHeight,(e,t,a,n,i,l,o)=>({sidebar:e,dialog:t,fullscreen:a,appId:n,singlePageApp:i,ww:l,hh:o}));var oi=Object(s.b)(e=>li(e),e=>({toggleFullscreen:(t,a,n,i)=>{const l=document.getElementById(a),o={};if(t){E(document.body,"trelliscope-fullscreen-body"),E(document.getElementsByTagName("html")[0],"trelliscope-fullscreen-html"),E(l,"trelliscope-fullscreen-el"),o.width=window.innerWidth,o.height=window.innerHeight;const e=document.getElementById("trelliscope-fullscreen-div");e.style.display="block",e.appendChild(l)}else x(document.body,"trelliscope-fullscreen-body"),x(document.getElementsByTagName("html")[0],"trelliscope-fullscreen-html"),x(l,"trelliscope-fullscreen-el"),o.width=n.width,o.height=n.height,document.getElementById("".concat(l.id,"-parent")).appendChild(l),document.getElementById("trelliscope-fullscreen-div").style.display="none",window.scrollTo(window.pageXOffset,i);e((e=>({type:"SET_FULLSCREEN",fullscreen:e}))(t)),e(N(o))}}))(Object(He.a)(ii)(ni)),si=a(285);const ri=Object(Z.a)(e=>e.errorMsg,e=>({errorMsg:e}));var ci=Object(s.b)(e=>ri(e),e=>({handleClose:()=>{e(Q(""))}}))(({errorMsg:e,handleClose:t})=>i.a.createElement(si.a,{anchorOrigin:{vertical:"bottom",horizontal:"center"},open:""!==e,onClose:t,SnackbarContentProps:{"aria-describedby":"message-id"},message:i.a.createElement("span",{id:"message-id"},e),action:[i.a.createElement(Je.a,{key:"undo",color:"secondary",dense:!0,onClick:t},"Close")]}));var di=()=>i.a.createElement("div",null,i.a.createElement(da,null),i.a.createElement(Wn,null),i.a.createElement(ai,null),i.a.createElement(oi,null),i.a.createElement(ci,null));const pi=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function hi(e,t){navigator.serviceWorker.register(e).then(e=>{e.onupdatefound=()=>{const a=e.installing;null!=a&&(a.onstatechange=()=>{"installed"===a.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See https://bit.ly/CRA-PWA."),t&&t.onUpdate&&t.onUpdate(e)):(console.log("Content is cached for offline use."),t&&t.onSuccess&&t.onSuccess(e)))})}}).catch(e=>{console.error("Error during service worker registration:",e)})}const mi=(e,t,a)=>{let n=!0,l={},m=!1;void 0!==a&&("boolean"===typeof a.logger?n=a.logger:void 0!==a.logger&&(l=a.logger),void 0!==a.callbacks&&(m=!0));const u=document.getElementById(e);E(u,"trelliscope-app"),E(u,"trelliscope-app-container"),"relative"!==u.style.position&&(u.style.position="relative"),"hidden"!==u.style.overflow&&(u.style.overflow="hidden"),u.style["font-family"]='"Open Sans", sans-serif',u.style["font-weight"]=300,u.style["-webkit-tap-highlight-color"]="rgba(0,0,0,0)";const f=void 0===u.style.height||""===u.style.height||"100%"===u.style.height,v=void 0===u.style.width||""===u.style.width||"100%"===u.style.width;let w=!1,x=!1;if(u.classList.contains("trelliscope-not-spa")||!f&&!v){const e=document.createElement("div");if(e.style.width="100%",e.style.height="100%",e.style.display="none",e.id="trelliscope-fullscreen-div",document.getElementsByTagName("body")[0].appendChild(e),f){0===[].slice.call(u.parentNode.childNodes).map(e=>3!==e.nodeType&&8!==e.nodeType).reduce((e,t)=>e+t)-1&&(u.style.height="".concat(u.parentNode.clientHeight,"px"),u.style.width="".concat(u.parentNode.clientWidth,"px"))}const t=u.parentNode,a=document.createElement("div");a.id="".concat(u.id,"-parent"),t.replaceChild(a,u),a.appendChild(u)}else w=!0,x=!0,u.style.width="100%",u.style.height="100%",E(document.body,"trelliscope-fullscreen-body"),E(document.getElementsByTagName("html")[0],"trelliscope-fullscreen-html");const S={};w?(S.width=window.innerWidth,S.height=window.innerHeight):(S.width=u.clientWidth,S.height=u.clientHeight),u.classList.contains("trelliscope-not-spa")||!f&&!v||(w=!0,x=!0);const _=[c.a,Oe];if(n){const e=Object(d.createLogger)(l);_.push(e)}if(m){const e=we(a.callbacks);_.push(e)}w&&_.push(y);const O=Object(r.d)(Fe,{appId:e,singlePageApp:w,fullscreen:x},Object(r.a)(..._));O.dispatch(N(S)),O.dispatch(D(S)),O.dispatch(((e="config.jsonp",t="",a=!1)=>n=>{const i=a?window.location.hash:"";if(!("string"===typeof e||e instanceof String)){n(j(e.config)),n(H(e.displayList));const t=e.displayList[0].name,a=e.displayList[0].group,i=e.displayList[0].desc;n(M(t,a,i)),n(G(t,a));const l=e.displayObj.cogInterface;n(K(t,a,e.displayObj)),n(Y(l)),n({type:"SET_LOCAL_PANELS",dat:e.panels}),J(l,e.cogData,e.displayObj,n,""),$(e.displayObj,e.config,n)}else{n({type:"REQUEST_CONFIG"});const l="__loadDisplayList__".concat(t),o="__loadTrscopeConfig__".concat(t),s=e.replace(/[^\/]*$/,""),r=e=>{let t=e;return/^https?:\/\/|^file:\/\/|^\//.test(e)||(t=s,""!==e&&(t+="".concat(e,"/"))),t};window[o]=e=>{if(e.display_base=r(e.display_base),e.config_base=s,e.cog_server.info.base=r(e.cog_server.info.base),n(j(e)),!0===e.require_token){const e="".concat(window.devicePixelRatio||"").concat(navigator.userAgent.replace(/\D+/g,"")),t="".concat(navigator.language.length||"").concat(window.screen.colorDepth||""),a="".concat((new Date).getTimezoneOffset()).concat(navigator.platform.length||""),i="".concat(window.screen.height||"").concat(window.screen.width||"").concat(window.screen.pixelDepth||""),l="".concat((new Date).toLocaleDateString().replace(/\D+/g,"")),o="".concat(e).concat(t).concat(a).concat(i).concat(l);if(localStorage.getItem("TRELLISCOPE_TOKEN")!==o)return void n(Q("Visualization could not be loaded because it is not embedded in a properly authenticated website."))}window[l]=l=>{l.sort((e,t)=>(void 0===e.order?1:e.order)>(void 0===t.order?1:t.order)?1:-1),n(H(l));const o={};if(i.replace("#","").split("&").forEach(e=>{const t=e.split("=");o[t[0]]=t[[1]]}),o.display){const a=l.map(e=>e.name).indexOf(o.display);if(a>-1){const o=l[a];n(M(o.name,o.group,o.desc)),n(X(o.name,o.group,e,t,i))}}else a&&l.length>1&&(n(L(!0)),n(R(!0)))},"jsonp"===e.data_type?C()({url:"".concat(e.display_base,"displayList.jsonp"),callbackName:l,error:e=>n(Q("Couldn't load display list: ".concat(e.url)))}):k({url:"".concat(e.display_base,"displayList.json"),callback:window[l]}).on("error",e=>n(Q("Couldn't load display list: ".concat(e.target.responseURL))))};const c=/\.([0-9a-z]+)(?:[\?#]|$)/i,d=e.match(c)[0];".jsonp"===d?C()({url:e,callbackName:o,error:e=>n(Q("Couldn't load config: ".concat(e.url)))}):".json"===d?k({url:e,callback:window[o]}):n(Q("Config specified as ".concat(e," must have extension '.json' or '.jsonp'")))}})(t,e,w)),window.addEventListener("resize",()=>{O.getState().fullscreen&&O.dispatch(N({height:window.innerHeight,width:window.innerWidth}))});const I=Object(p.a)({palette:{primary:{light:g.a.A100,main:g.a.A200},secondary:{light:b.a[200],main:b.a[700]}},typography:{fontFamily:'"Open Sans", sans-serif',fontWeightLight:200,fontWeightRegular:300,fontWeightMedium:400}});return o.a.render(i.a.createElement(h.a,{theme:I},i.a.createElement(s.a,{store:O},i.a.createElement(di,null))),document.getElementById(e)),{resize:(e,t)=>{u.style.height="".concat(t,"px"),u.style.width="".concat(e,"px"),O.dispatch(D({width:e,height:t})),O.dispatch(N({width:e,height:t}))},setLayout:(e,t)=>{O.dispatch(z({nrow:e,ncol:t}))},currentCogs:()=>ve(O.getState())}};window.trelliscopeApp=mi,mi("22375e25","_test/example_gapminder/config.jsonp",{logger:!0}),function(e){if("serviceWorker"in navigator){if(new URL("",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",()=>{const t="".concat("","/service-worker.js");pi?(!function(e,t){fetch(e).then(a=>{const n=a.headers.get("content-type");404===a.status||null!=n&&-1===n.indexOf("javascript")?navigator.serviceWorker.ready.then(e=>{e.unregister().then(()=>{window.location.reload()})}):hi(e,t)}).catch(()=>{console.log("No internet connection found. App is running in offline mode.")})}(t,e),navigator.serviceWorker.ready.then(()=>{console.log("This web app is being served cache-first by a service worker. To learn more, visit https://bit.ly/CRA-PWA")})):hi(t,e)})}}()}},[[169,1,2]]]);
//# sourceMappingURL=main.f2805fba.chunk.js.map